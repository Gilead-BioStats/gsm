meta:
  File: reporting.yaml
  description: Generate reporting data model including site-, country- and study-level metadata (dfGroups), metric metadata (dfMetrics) and results data with added study-level columsn (dfSummary and dfBounds).
spec: 
  Mapped_COUNTRY:
    _all:
      required: true
  Mapped_SITE:
    _all:
      required: true
  Mapped_STUDY:
    _all:
      required: true
steps:
  # Combine CTMS and Counts data as dfGroups
  - name: bind_rows
    output: Reporting_Groups
    params:
      Country: Mapped_COUNTRY
      Site: Mapped_SITE
      Study: Mapped_STUDY

# Create Metric Medatadata
  - name: MakeMetric
    output: Reporting_Metrics
    params:
      lWorkflows: lWorkflows

# Stack dfSummary data into dfResults
  - name: BindResults
    output: Reporting_Results
    params:
      lAnalysis: lAnalysis
      strName: "Analysis_Summary"
      dSnapshotDate: dSnapshotDate
      strStudyID: strStudyID

# Calculate Bounds for confidence intervals
  - name: MakeBounds
    output: Reporting_Bounds
    params:
      dfResults: Reporting_Results
      dfMetrics: Reporting_Metrics

