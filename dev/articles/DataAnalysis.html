<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Step-by-Step Analysis Workflow • gsm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Step-by-Step Analysis Workflow">
<meta name="description" content="This vignette walks users through the mechanics of the functions that produce all of the Analysis workflow output within the `{gsm}` package.">
<meta property="og:description" content="This vignette walks users through the mechanics of the functions that produce all of the Analysis workflow output within the `{gsm}` package.">
<meta name="robots" content="noindex">
<link href="pkgdown/extra.css" rel="stylesheet">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsm</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Gilead-BioStats/gsm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="DataAnalysis_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="DataAnalysis_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="DataAnalysis_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="DataAnalysis_files/datatables-binding-0.33/datatables.js"></script><link href="DataAnalysis_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="DataAnalysis_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="DataAnalysis_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="DataAnalysis_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="DataAnalysis_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Step-by-Step Analysis Workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/gsm/blob/dev/vignettes/DataAnalysis.Rmd" class="external-link"><code>vignettes/DataAnalysis.Rmd</code></a></small>
      <div class="d-none name"><code>DataAnalysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette walks users through the mechanics of the functions that
produce all of the Analysis workflow output within the
<a href="https://github.com/Gilead-BioStats/gsm" class="external-link">gsm</a> package. <a href="https://github.com/Gilead-BioStats/gsm" class="external-link">gsm</a> leverages Key Risk
Indicators (KRIs) and thresholds to conduct study-level and site-level
Risk Based Monitoring for clinical trials.</p>
<p>These functions provide data frames, visualizations, and metadata to
be used in reporting and error checking at clinical sites. The image
below illustrates the supporting functions that feed into the yaml
workflow that is specified in each analysis workflow.</p>
<p><img src="data_analysis.png" style="width:100.0%"></p>
<p>All of these functions will run automatically and sequentially when a
user calls upon the <code><a href="../reference/RunWorkflow.html">RunWorkflow()</a></code> function with a specified
yaml file for KRI metrics found in the <code>workflow/2_metrics</code>
directory of the <a href="https://github.com/Gilead-BioStats/gsm" class="external-link">gsm</a> package.</p>
<p>Each of these individual functions can also be run independently
outside of a specified yaml workflow.</p>
<p>For the purposes of this documentation, we will evaluate the input(s)
and output(s) of each individual function for a specific KRI to show the
stepwise progression of how a yaml workflow is set up to handle and
process data.</p>
<hr>
<div class="section level3">
<h3 id="case-study---step-by-step-adverse-event-kri">Case Study - Step-by-Step Adverse Event KRI<a class="anchor" aria-label="anchor" href="#case-study---step-by-step-adverse-event-kri"></a>
</h3>
<p>We will use sample clinical data from the <a href="https://github.com/Gilead-BioStats/clindata" class="external-link"><code>{clindata}</code></a>
package to run the Adverse Events (AE) Assessment, i.e.,
<code>AE_Assess()</code>, using the normal approximation method.</p>
<p>Additional statistical methods and supporting functions are explored
in <a href="#appendix-1">Appendix 1</a>.</p>
<div class="section level4">
<h4 id="create-dfinput">1. Create <code>dfInput</code><a class="anchor" aria-label="anchor" href="#create-dfinput"></a>
</h4>
<p>Start by creating <code>dfInput</code> using sample rawplus data from
<a href="https://gilead-biostats.github.io/clindata/" class="external-link">clindata</a>. Note that <code><a href="../reference/Input_Rate.html">Input_Rate()</a></code> requires
three specific datasets from <a href="https://gilead-biostats.github.io/clindata/" class="external-link">clindata</a>, which include a
subject-level demographics/exposure dataset (<code>dfSubjects</code>)
and a domain-level dataset (<code>dfNumerator</code>) that records every
adverse event per subject.</p>
<p>Since <code><a href="../reference/Input_Rate.html">Input_Rate()</a></code> is a generalized function, it is also
required that you specify the relevant column names for the Subject
(<code>strSubjectCol</code>), Group (<code>strGroupCol</code>) and
optionally the Denominator (<code>strDenominatorCol</code>) and
Numerator (<code>strNumeratorCol</code>) when it is not simply
“Denominator” or “Numerator”, respectively.</p>
<p>Finally, the method for calculating the Numerator and Denominator is
specified in <code>strNumeratorMethod</code> and
<code>strDenominatorMethod</code> as either “Count” or “Sum”. If the
method is “Count”, the function simply counts the number of rows in the
provided data frame. If the numerator method is “Sum”, the function
takes the sum of the values in the specified column (strNumeratorCol or
strDenominatorCol).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfInput</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Input_Rate.html">Input_Rate</a></span><span class="op">(</span></span>
<span>              dfSubjects <span class="op">=</span> <span class="fu">gsm</span><span class="fu">::</span><span class="va"><a href="../reference/lSource.html">lSource</a></span><span class="op">$</span><span class="va">Raw_SUBJ</span>,</span>
<span>              dfNumerator <span class="op">=</span> <span class="fu">gsm</span><span class="fu">::</span><span class="va"><a href="../reference/lSource.html">lSource</a></span><span class="op">$</span><span class="va">Raw_AE</span>,</span>
<span>              dfDenominator <span class="op">=</span> <span class="fu">gsm</span><span class="fu">::</span><span class="va"><a href="../reference/lSource.html">lSource</a></span><span class="op">$</span><span class="va">Raw_SUBJ</span>,</span>
<span>              strSubjectCol <span class="op">=</span> <span class="st">"subjid"</span>,</span>
<span>              strGroupCol <span class="op">=</span> <span class="st">"siteid"</span>,</span>
<span>              strNumeratorMethod <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>              strDenominatorMethod <span class="op">=</span> <span class="st">"Sum"</span>,</span>
<span>              strDenominatorCol <span class="op">=</span> <span class="st">"timeonstudy"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The data frame <code>dfInput</code> for an AE assessment will be
created by running <code><a href="../reference/Input_Rate.html">Input_Rate()</a></code> and will have one record
per subject, with the following columns:</p>
<ul>
<li>
<code>SubjectID</code>: Subject Identifier</li>
<li>
<code>GroupID</code>: Group Identifier</li>
<li>
<code>GroupLevel</code>: Type of Group specified in
<code>GroupID</code> (Country, Site)</li>
<li>
<code>Numerator</code>: Total Time on Treatment (measured in days;
per subject)</li>
<li>
<code>Denominator</code>: Total Number of Event(s) of Interest (in
this example, the number of AEs reported; per subject)</li>
<li>
<code>Metric</code>: Rate of Event Incidence (calculated as
<code>Exposure</code>/<code>Count</code>; per subject)</li>
</ul>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["S69231","S22973","S52850","S4912","S10300","S76907","S99700","S18546","S78773","S29369","S46842","S58101","S36085","S76722","S82170","S9181","S71847","S88851","S82584","S56518","S24670","S93647","S34133","S47799","S25195","S65777","S7070","S40159","S1497","S57336","S60586","S20697","S65614","S9722","S34598","S4517","S62169","S81881","S4694","S32101","S78888","S81024","S97141","S74983","S92555","S53288","S16435","S26690","S53704","S42886","S30236","S66765","S35555","S32075","S26714","S18387","S82525","S23976","S68615","S63480","S31314","S43754","S45554","S57942","S74658","S73798","S20399","S4971","S69044","S37491","S6372","S73395","S82755","S601","S74058","S47605","S28576","S7876","S58262","S2776","S30711","S17748","S7487","S76661","S45429","S9738","S61774","S19511","S80142","S49587","S49752","S90498","S52291","S38244","S99045","S4681","S68956","S37764","S34826","S86478"],["Site2979","Site2979","Site554","Site2979","Site1613","Site1613","Site554","Site1613","Site2979","Site554","Site2979","Site2979","Site554","Site1613","Site2979","Site2979","Site1613","Site1613","Site1613","Site1613","Site2979","Site554","Site554","Site1613","Site554","Site554","Site554","Site1613","Site554","Site554","Site1613","Site1613","Site554","Site1613","Site554","Site1613","Site1613","Site2979","Site1613","Site554","Site2979","Site2979","Site554","Site1613","Site2979","Site2979","Site554","Site554","Site554","Site2979","Site1613","Site1613","Site554","Site554","Site554","Site554","Site1613","Site2979","Site554","Site1613","Site2979","Site554","Site554","Site554","Site1613","Site2979","Site1613","Site554","Site2979","Site1613","Site2979","Site1613","Site1613","Site554","Site1613","Site1613","Site1613","Site1613","Site1613","Site554","Site2979","Site2979","Site554","Site554","Site554","Site554","Site1613","Site2979","Site2979","Site554","Site1613","Site1613","Site554","Site2979","Site554","Site554","Site2979","Site2979","Site554","Site554"],["siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid","siteid"],[3,1,1,4,3,3,1,2,3,4,8,3,2,5,4,3,6,4,6,4,4,5,2,2,1,1,2,3,4,1,5,0,4,6,5,3,2,3,4,3,5,2,4,1,1,0,4,3,5,3,4,4,2,2,1,1,0,1,2,5,2,4,3,2,4,1,4,3,6,4,4,2,5,3,3,5,3,1,1,1,4,2,4,1,4,0,0,3,4,4,2,2,6,5,2,4,4,2,3,3],[0,14,23,0,17,17,5,4,14,0,0,13,0,4,0,21,10,0,0,0,0,8,8,13,13,19,19,3,10,2,7,27,0,8,21,0,29,13,19,1,18,20,12,25,0,21,22,28,0,9,0,23,0,30,29,3,0,2,1,15,26,10,0,27,0,0,28,16,21,24,5,24,29,0,13,0,28,23,17,22,16,14,24,0,0,30,0,28,6,29,20,27,23,11,20,0,13,9,17,28],[null,0.07142857142857142,0.04347826086956522,null,0.1764705882352941,0.1764705882352941,0.2,0.5,0.2142857142857143,null,null,0.2307692307692308,null,1.25,null,0.1428571428571428,0.6,null,null,null,null,0.625,0.25,0.1538461538461539,0.07692307692307693,0.05263157894736842,0.1052631578947368,1,0.4,0.5,0.7142857142857143,0,null,0.75,0.2380952380952381,null,0.06896551724137931,0.2307692307692308,0.2105263157894737,3,0.2777777777777778,0.1,0.3333333333333333,0.04,null,0,0.1818181818181818,0.1071428571428571,null,0.3333333333333333,null,0.1739130434782609,null,0.06666666666666667,0.03448275862068965,0.3333333333333333,null,0.5,2,0.3333333333333333,0.07692307692307693,0.4,null,0.07407407407407407,null,null,0.1428571428571428,0.1875,0.2857142857142857,0.1666666666666667,0.8,0.08333333333333333,0.1724137931034483,null,0.2307692307692308,null,0.1071428571428571,0.04347826086956522,0.05882352941176471,0.04545454545454546,0.25,0.1428571428571428,0.1666666666666667,null,null,0,null,0.1071428571428571,0.6666666666666666,0.1379310344827586,0.1,0.07407407407407407,0.2608695652173913,0.4545454545454545,0.1,null,0.3076923076923077,0.2222222222222222,0.1764705882352941,0.1071428571428571]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SubjectID<\/th>\n      <th>GroupID<\/th>\n      <th>GroupLevel<\/th>\n      <th>Numerator<\/th>\n      <th>Denominator<\/th>\n      <th>Metric<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"SubjectID","targets":1},{"name":"GroupID","targets":2},{"name":"GroupLevel","targets":3},{"name":"Numerator","targets":4},{"name":"Denominator","targets":5},{"name":"Metric","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script><hr>
</div>
<div class="section level4">
<h4 id="create-dftransformed">2. Create <code>dfTransformed</code><a class="anchor" aria-label="anchor" href="#create-dftransformed"></a>
</h4>
<p>The data frame <code>dfTransformed</code> is derived from
<code>dfInput</code> using a <code>Transform()</code> function. In our
example, the analysis pipeline pulls in <code><a href="../reference/Transform_Rate.html">Transform_Rate()</a></code>
since the default metric for AEs is the number of AEs reported over the
course of treatment per site, i.e., a rate.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfTransformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Transform_Rate.html">Transform_Rate</a></span><span class="op">(</span><span class="va">dfInput</span><span class="op">)</span></span></code></pre></div>
<p>The resulting <code>dfTransformed</code> data frame will contain
site-level transformed data, including KRI calculation. Using our
example AE data, <code>dfTransformed</code> contains the following
columns:</p>
<ul>
<li>
<code>GroupID</code>: Group Identifier (default is Site ID)</li>
<li>
<code>GroupLevel</code>: Type of Group specified in
<code>GroupID</code> (Country, Site)</li>
<li>
<code>Numerator</code>: Cumulative Number of Event(s) of Interest
(in this example, number of AEs reported across subjects)</li>
<li>
<code>Denominator</code>: Cumulative Time on Treatment (in days,
across subjects)</li>
<li>
<code>Metric</code>: Rate of Event(s) of Interest (in this example,
number of AEs reported over the course of treatment in days)</li>
</ul>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["Site1613","Site2979","Site554"],["siteid","siteid","siteid"],[108,85,107],[454,294,500],[0.2378854625550661,0.2891156462585034,0.214]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>GroupID<\/th>\n      <th>GroupLevel<\/th>\n      <th>Numerator<\/th>\n      <th>Denominator<\/th>\n      <th>Metric<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"GroupID","targets":1},{"name":"GroupLevel","targets":2},{"name":"Numerator","targets":3},{"name":"Denominator","targets":4},{"name":"Metric","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script><hr>
</div>
<div class="section level4">
<h4 id="create-dfanalyzed">3. Create <code>dfAnalyzed</code><a class="anchor" aria-label="anchor" href="#create-dfanalyzed"></a>
</h4>
<p>The data frame <code>dfAnalyzed</code> is derived from
<code>dfTransformed</code> using an <code>Analyze()</code> function,
which incorporates a specific statistical model. The resulting
<code>dfAnalyzed</code> data frame will contain site-level analysis
results data. The normal approximation method is the default statistical
model for AE data, so the analysis pipeline automatically runs
<code><a href="../reference/Analyze_NormalApprox.html">Analyze_NormalApprox()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfAnalyzed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Analyze_NormalApprox.html">Analyze_NormalApprox</a></span><span class="op">(</span><span class="va">dfTransformed</span><span class="op">)</span></span>
<span><span class="co">#&gt; `OverallMetric`, `Factor`, and `Score` columns created from normal</span></span>
<span><span class="co">#&gt; approximation.</span></span></code></pre></div>
<p>Using our example AE data, <code>dfAnalyzed</code> contains the
following columns:</p>
<ul>
<li>
<code>GroupID</code>: Group Identifier (default is Site ID)</li>
<li>
<code>GroupLevel</code>: Type of Group specified in
<code>GroupID</code> (Country, Site)</li>
<li>
<code>Numerator</code>: Cumulative Number of Event(s) of Interest
(in this example, number of AEs reported across subjects); Carried from
<code>dfTransformed</code>.</li>
<li>
<code>Denominator</code>: Cumulative Time on Treatment (in days,
across subjects); Carried from <code>dfTransformed</code>.</li>
<li>
<code>Metric</code>: Rate of Event(s) of Interest (in this example,
number of AEs reported over the course of treatment in days); Carried
from <code>dfTransformed</code>.</li>
<li>
<code>OverallMetric</code>: Aggregate metric for the group that is
being assessed. ( sum(Numerator) / sum(Denominator) ).</li>
<li>
<code>Factor</code>: Calculated over-dispersion adjustment factor
(mean of the z-score sum of squares calculated in the analysis
functions).</li>
<li>
<code>Score</code>: Calculated Residual (per site).</li>
</ul>
<div class="datatables html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["Site554","Site1613","Site2979"],["siteid","siteid","siteid"],[107,108,85],[500,454,294],[0.214,0.2378854625550661,0.2891156462585034],[0.2403846153846154,0.2403846153846154,0.2403846153846154],[1.915071417340407,1.915071417340407,1.915071417340407],[-0.9976841483450922,-0.09004882362544107,1.41298179376261]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>GroupID<\/th>\n      <th>GroupLevel<\/th>\n      <th>Numerator<\/th>\n      <th>Denominator<\/th>\n      <th>Metric<\/th>\n      <th>OverallMetric<\/th>\n      <th>Factor<\/th>\n      <th>Score<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"GroupID","targets":1},{"name":"GroupLevel","targets":2},{"name":"Numerator","targets":3},{"name":"Denominator","targets":4},{"name":"Metric","targets":5},{"name":"OverallMetric","targets":6},{"name":"Factor","targets":7},{"name":"Score","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script><hr>
</div>
<div class="section level4">
<h4 id="create-dfflagged">4. Create <code>dfFlagged</code><a class="anchor" aria-label="anchor" href="#create-dfflagged"></a>
</h4>
<p>The data frame <code>dfFlagged</code> is derived from
<code>dfAnalyzed</code> using a <code><a href="../reference/Flag.html">Flag()</a></code> function. The
resulting <code>dfFlagged</code> data frame will contain site-level
analysis results data with flagging incorporated based on a
pre-specified statistical threshold to highlight possible outliers.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfFlagged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Flag_NormalApprox.html">Flag_NormalApprox</a></span><span class="op">(</span><span class="va">dfAnalyzed</span>, vThreshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Sorted dfFlagged using custom Flag order: 2.Sorted dfFlagged using custom Flag order: -2.Sorted dfFlagged using custom Flag order: 1.Sorted dfFlagged using custom Flag order: -1.Sorted dfFlagged using custom Flag order: 0.</span></span></code></pre></div>
<p>The default flagging function for the normal approximation method is
<code><a href="../reference/Flag_NormalApprox.html">Flag_NormalApprox()</a></code> and the default threshold is (-3, -2,
2, 3). Using our example AE data, <code>dfFlagged</code> contains the
following columns:</p>
<ul>
<li>
<code>GroupID</code>: Group Identifier (default is Site ID)</li>
<li>
<code>GroupLevel</code>: Type of Group specified in
<code>GroupID</code> (Country, Site)</li>
<li>
<code>Numerator</code>: Cumulative Number of Event(s) of Interest
(in this example, number of AEs reported across subjects); Carried from
<code>dfAnalyzed</code>
</li>
<li>
<code>Denominator</code>: Cumulative Time on Treatment (in days,
across subjects); Carried from <code>dfAnalyzed</code>
</li>
<li>
<code>Metric</code>: Rate of Event(s) of Interest (in this example,
number of AEs reported over the course of treatment in days); Carried
from <code>dfAnalyzed</code>
</li>
<li>
<code>OverallMetric</code>: Aggregate metric for the group that is
being assessed. ( sum(Numerator) / sum(Denominator) ).</li>
<li>
<code>Factor</code>: Calculated over-dispersion adjustment factor
(mean of the z-score sum of squares calculated in the analysis
functions); Carried from <code>dfAnalyzed</code>.</li>
<li>
<code>Score</code>: Calculated Residual (per site); Carried from
<code>dfAnalyzed</code>
</li>
<li>
<code>Flag</code>: Flag Indicating Possible Statistical Outliers;
Valid values for this variable include -2, -1, 0, 1, and 2, which
determine the “extremeness” of the outlier. -2 and 2 represent more
extreme outliers, -1 and 1 represent less extreme outliers, and 0
represents a non-outlier.</li>
</ul>
<div class="datatables html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["Site554","Site1613","Site2979"],["siteid","siteid","siteid"],[107,108,85],[500,454,294],[0.214,0.2378854625550661,0.2891156462585034],[0.2403846153846154,0.2403846153846154,0.2403846153846154],[1.915071417340407,1.915071417340407,1.915071417340407],[-0.9976841483450922,-0.09004882362544107,1.41298179376261],[0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>GroupID<\/th>\n      <th>GroupLevel<\/th>\n      <th>Numerator<\/th>\n      <th>Denominator<\/th>\n      <th>Metric<\/th>\n      <th>OverallMetric<\/th>\n      <th>Factor<\/th>\n      <th>Score<\/th>\n      <th>Flag<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8,9]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"GroupID","targets":1},{"name":"GroupLevel","targets":2},{"name":"Numerator","targets":3},{"name":"Denominator","targets":4},{"name":"Metric","targets":5},{"name":"OverallMetric","targets":6},{"name":"Factor","targets":7},{"name":"Score","targets":8},{"name":"Flag","targets":9}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><hr>
</div>
<div class="section level4">
<h4 id="create-dfsummary">5. Create <code>dfSummary</code><a class="anchor" aria-label="anchor" href="#create-dfsummary"></a>
</h4>
<p>The data frame <code>dfSummary</code> is derived from
<code>dfFlagged</code> using the <code><a href="../reference/Summarize.html">Summarize()</a></code> function. The
resulting <code>dfSummary</code> data frame will contain the most
relevant columns from <code>dfFlagged</code> with data sorted in a
meaningful way to provide a concise overview of the assessment. Flagged
sites will sort earlier than non-flagged sites, with the more “extreme”
outliers displayed first. The columns in <code>dfSummary</code>
include:</p>
<ul>
<li>
<code>GroupID</code>: Group Identifier (default is Site ID)</li>
<li>
<code>GroupLevel</code>: Type of Group specified in
<code>GroupID</code> (Country, Site)</li>
<li>
<code>Numerator</code>: Cumulative Number of Event(s) of Interest
(in this example, number of AEs reported across subjects); Carried from
<code>dfAnalyzed</code>
</li>
<li>
<code>Denominator</code>: Cumulative Time on Treatment (in days,
across subjects); Carried from <code>dfAnalyzed</code>
</li>
<li>
<code>Metric</code>: Rate of Event(s) of Interest (in this example,
number of AEs reported over the course of treatment in days)</li>
<li>
<code>Score</code>: Calculated Residual (per site)</li>
<li>
<code>Flag</code>: Flag Indicating Possible Statistical Outliers;
Valid values for this variable include -2, -1, 0, 1, and 2, which
determine the “extremeness” of the outlier. -2 and 2 represent more
extreme outliers, -1 and 1 represent less extreme outliers, and 0
represents a non-outlier.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfSummary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Summarize.html">Summarize</a></span><span class="op">(</span><span class="va">dfFlagged</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1fb4450895fe099f74a1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"filter":"none","vertical":false,"data":[["1","2"],["Site1613","Site554"],["siteid","siteid"],[108,107],[454,500],[0.2378854625550661,0.214],[-0.09004882362544107,-0.9976841483450922],[0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>GroupID<\/th>\n      <th>GroupLevel<\/th>\n      <th>Numerator<\/th>\n      <th>Denominator<\/th>\n      <th>Metric<\/th>\n      <th>Score<\/th>\n      <th>Flag<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"GroupID","targets":1},{"name":"GroupLevel","targets":2},{"name":"Numerator","targets":3},{"name":"Denominator","targets":4},{"name":"Metric","targets":5},{"name":"Score","targets":6},{"name":"Flag","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="recap---normal-approximation-adverse-event-kri">Recap - Normal Approximation Adverse Event KRI<a class="anchor" aria-label="anchor" href="#recap---normal-approximation-adverse-event-kri"></a>
</h2>
<ul>
<li>
<code>dfInput</code> used as original input using
<code><a href="../reference/Input_Rate.html">Input_Rate()</a></code>
</li>
<li>
<code>dfTransformed</code> created from <code>dfInput</code> using
<code><a href="../reference/Transform_Rate.html">Transform_Rate()</a></code>
</li>
<li>
<code>dfAnalyzed</code> created from <code>dfTransformed</code>
using <code><a href="../reference/Analyze_NormalApprox.html">Analyze_NormalApprox()</a></code>
</li>
<li>
<code>dfFlagged</code> created from <code>dfAnalyzed</code> using
<code><a href="../reference/Flag_NormalApprox.html">Flag_NormalApprox()</a></code>
</li>
<li>
<code>dfSummary</code> created from <code>dfFlagged</code> using
<code><a href="../reference/Summarize.html">Summarize()</a></code>
</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="appendix-1">Appendix 1 - Supporting Functions<a class="anchor" aria-label="anchor" href="#appendix-1"></a>
</h2>
<p>The following sections include various examples of supporting
functions and statistical models that can be employed in the Analysis
workflow. Please note that this is <strong>not</strong> an exhaustive
list, but includes some of the most commonly called upon functions.</p>
<div class="section level4">
<h4 id="mapping-functions">Mapping Functions<a class="anchor" aria-label="anchor" href="#mapping-functions"></a>
</h4>
<ul>
<li>
<code><a href="../reference/RunQuery.html">RunQuery()</a></code>: Run a SQL query to create new data.frames
with filtering and column name specifications.</li>
<li>
<code><a href="../reference/Input_Rate.html">Input_Rate()</a></code>: Calculate a subject level rate from raw
numerator and denominator data</li>
</ul>
</div>
<div class="section level4">
<h4 id="transform-functions">Transform Functions<a class="anchor" aria-label="anchor" href="#transform-functions"></a>
</h4>
<ul>
<li>
<code><a href="../reference/Transform_Rate.html">Transform_Rate()</a></code>: Calculates cumulative rate of
Event(s) of Interest per site</li>
<li>
<code><a href="../reference/Transform_Count.html">Transform_Count()</a></code>: Calculates cumulative number of
Event(s) of Interest per site</li>
</ul>
</div>
<div class="section level4">
<h4 id="analyze-functions">Analyze Functions<a class="anchor" aria-label="anchor" href="#analyze-functions"></a>
</h4>
<ul>
<li>
<code><a href="../reference/Analyze_NormalApprox.html">Analyze_NormalApprox()</a></code>: Uses funnel plot method with
normal approximation to create analysis results for
percentage/rate.</li>
<li>
<code><a href="../reference/Analyze_Fisher.html">Analyze_Fisher()</a></code>: Uses Fisher’s Exact Test to determine
if there are non-random associations between a site and a given KRI</li>
<li>
<code><a href="../reference/Analyze_Identity.html">Analyze_Identity()</a></code>: Used in the data pipeline between
<code>Transform()</code> and <code><a href="../reference/Flag.html">Flag()</a></code> functions to rename KRI
and Score columns</li>
<li>
<code><a href="../reference/Analyze_Poisson.html">Analyze_Poisson()</a></code>: Uses a Poisson model to describe the
distribution of events in the overall site population, i.e., determine
how many times an event is likely to occur at a site over a specified
treatment period</li>
</ul>
</div>
<div class="section level4">
<h4 id="flag-functions">Flag Functions<a class="anchor" aria-label="anchor" href="#flag-functions"></a>
</h4>
<ul>
<li>
<code><a href="../reference/Flag_NormalApprox.html">Flag_NormalApprox()</a></code>: Default flagging function when
<code><a href="../reference/Analyze_NormalApprox.html">Analyze_NormalApprox()</a></code> is used for an assessment.</li>
<li>
<code>Flag_Fisher()</code>: Default flagging function when
<code><a href="../reference/Analyze_Fisher.html">Analyze_Fisher()</a></code> is used for an assessment</li>
<li>
<code><a href="../reference/Flag_Poisson.html">Flag_Poisson()</a></code>: Default flagging function when
<code><a href="../reference/Analyze_Poisson.html">Analyze_Poisson()</a></code> is used for an assessment</li>
<li>
<code><a href="../reference/Flag.html">Flag()</a></code>: Default flagging function when
<code><a href="../reference/Analyze_Identity.html">Analyze_Identity()</a></code> is used for an assessment</li>
</ul>
</div>
<div class="section level4">
<h4 id="what-statistical-models-are-available-for-each-assessment">What Statistical Models Are Available For Each Assessment?<a class="anchor" aria-label="anchor" href="#what-statistical-models-are-available-for-each-assessment"></a>
</h4>
<ul>
<li>By default, all yaml workflow assessments specified in the
<code>inst/workflows/</code> directory use the <a href="https://gilead-biostats.github.io/gsm/articles/KRI%20Method.html#the-normal-approximation-method">normal
approximation</a> method.</li>
<li>Optionally, other statistical methods include: <a href="https://gilead-biostats.github.io/gsm/articles/KRI%20Method.html#the-poisson-regression-method"><strong>Poisson</strong></a>,
<a href="https://gilead-biostats.github.io/gsm/articles/KRI%20Method.html#the-fishers-exact-method"><strong>Fisher’s
Exact</strong></a>, and <a href="https://gilead-biostats.github.io/gsm/articles/KRI%20Method.html#the-identity-method"><strong>Identity</strong></a>.</li>
</ul>
<p><img src="data_analysis_combined.png" style="width:100.0%"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by George Wu, Jeremy Wildfire, Matt Roumaya, Spencer Childress, Laura Maxwell, Jacob Anderson, Jon Harmon, Zelos Zhu, Nathan Kosiba, Douglas Sanders, Li Ge, Zhongkai Wang, Colleen McLaughlin, Chelsea Dickens, Maya Gans, Anne Zheng, Devin Pastoor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
