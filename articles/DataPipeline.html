<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data Pipeline • gsm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data Pipeline">
<meta property="og:description" content="gsm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cookbook.html">Cookbook</a>
    </li>
    <li>
      <a href="../articles/DataPipeline.html">Data Pipeline</a>
    </li>
    <li>
      <a href="../articles/ContributorGuidelines.html">Contributor Guidelines</a>
    </li>
    <li>
      <a href="../articles/Qualification.html">Qualification of ```gsm```</a>
    </li>
    <li>
      <a href="../articles/QualificationWorkflow.html">Qualification Workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Gilead-BioStats/gsm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="DataPipeline_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data Pipeline</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/gsm/blob/HEAD/vignettes/DataPipeline.Rmd" class="external-link"><code>vignettes/DataPipeline.Rmd</code></a></small>
      <div class="hidden name"><code>DataPipeline.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>The {gsm} package provides a standardized workflow that leverages Key Risk Indicators (KRIs) and thresholds to conduct study-level Risk Based Monitoring (RBM) for clinical trials. This vignette provides an overview of the {gsm} data model. First, we provide an overview of the standardized data pipeline used to calculate KRIs and evaluate thresholds to set site-level flags. We also discuss workflows and reports that allow users to run multiple KRIs concurrently on a study.</p>
</div>
<div class="section level2">
<h2 id="kri-data-pipeline">KRI Data Pipeline<a class="anchor" aria-label="anchor" href="#kri-data-pipeline"></a>
</h2>
<p><img width="862" alt="image" src="https://user-images.githubusercontent.com/3680095/169086356-e31ab9a5-c709-46cf-9bd9-68b7bdbba72b.png"></p>
<p>In the context of clinical research, a KRI is a measure of risk associated with the conduct of a clinical trial. Examples of KRIs include the rate of adverse events or amount of missing data at a site or across sites. Defining and deploying KRIs during study start-up allows sponsors to continually monitor risks to the integrity of the trial and take corrective actions accordingly.</p>
<p>The KRI data pipeline begins with one or more clinical datasets related to the KRI. An optional participant-level subset is then applied to each dataset before aggregating by participant to quantify the KRI at the participant level. This aggregated dataset is then further summarized by site to obtain site-level metrics.</p>
<div class="section level3">
<h3 id="assessment-data-pipeline">Assessment Data Pipeline<a class="anchor" aria-label="anchor" href="#assessment-data-pipeline"></a>
</h3>
<p><img width="862" alt="image" src="https://user-images.githubusercontent.com/3680095/157536920-81fa77b1-2ded-4e5b-8915-07537c1fb8d5.png"></p>
<p>The image above provides an overview of the KRI assessment pipeline. The pipeline is a standardized four-step process for <strong>assessing</strong> data issues by going from participant-level <code>input</code> data to a standardized site-level <code>summary</code> of model results. The functions used in each step of the data pipeline along with the input and output datasets are described in more detail below.</p>
<ol style="list-style-type: decimal">
<li>
<code>input</code> data - Cross-domain participant-level input data with all needed data for KRI derivation.</li>
<li>
<code>transformed</code> data - Site-level transformed data including KRI calculation. Created by <code>Transform</code> functions.</li>
<li>
<code>analyzed</code> data - Site-level analysis result data. Created by <code>Analyze</code> functions.</li>
<li>
<code>flagged</code> data - Site-level analysis results with flags added. Created by passing numeric <code>thresholds</code> to a <code>Flag</code> function.</li>
<li>
<code>summary</code> data - Standardized subset of the flagged data. This summary data has the same structure for all assessments and always includes both <code>KRI</code> and <code>Flag</code> values so that we can easily look at trends for any given site across multiple assessments. Created using a <code>Summarize</code> Function.</li>
</ol>
<p>Finally, each assessment has an <code>Assess</code> function that sequentially executes all 4 of the functions and returns a list containing all 5 data sets listed above.</p>
</div>
<div class="section level3">
<h3 id="generating-input-data">Generating <code>input</code> data<a class="anchor" aria-label="anchor" href="#generating-input-data"></a>
</h3>
<p>Creating input data is outside the scope of the assessment pipeline. The specifications for <code>input</code> data are designed so that the data can easily be generated from multiple clinical data standards (e.g. Raw, ADaM or SDTM). Most assessments have <code>Map</code> functions that can be used to generate <code>input</code> data. For example, the Adverse Event assessment has 2 map functions, <code><a href="../reference/AE_Map_Raw.html">AE_Map_Raw()</a></code> and <code><a href="../reference/AE_Map_Adam.html">AE_Map_Adam()</a></code>, which create <code>input</code> data from Raw and ADaM data respectively.</p>
<p>These <code>map</code> functions are provided for convenience but may not work for all clinical studies. When no <code>map</code> function is available for a given assessment, the user is expected to manually create <code>input</code> data following the specifications for that assessment.</p>
</div>
</div>
<div class="section level2">
<h2 id="running-multiple-assessments">Running Multiple Assessments<a class="anchor" aria-label="anchor" href="#running-multiple-assessments"></a>
</h2>
<p>Running multiple assessments for a single study is a common use case and {gsm} provides workflow and reporting functions to streamline this process.</p>
<p><code><a href="../reference/Study_Assess.html">Study_Assess()</a></code> attempts to run one or more assessment workflows using shared data and metadata. The metadata used for this study-level assessment is described in detail in <a href="#Appendix-1-Metadata-Technical-Specifications">Appendix 1</a>. The <code><a href="../reference/Study_Assess.html">Study_Assess()</a></code> function returns a list of assessments containing status information and results that is used as input for the reporting functions described below.</p>
<p><code><a href="../reference/Study_Report.html">Study_Report()</a></code> creates a detailed report showing both charts and listings summarizing each KRI that was run for the study, along with a study-level table (via <code><a href="../reference/Study_Table.html">Study_Table()</a></code>), and a summary of the workflow run to generate each KRI (via <code>Study_AssessmentTable()</code>) .</p>
<p>To see a sample report, simply run:</p>
<pre><code><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Study_Assess.html">Study_Assess</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Study_Report.html">Study_Report</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre>
<p>Many additional examples are provided in the <a href="Cookbook.html"><code>Cookbook</code> Vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="appendix-1---metadata-technical-specifications">Appendix 1 - Metadata Technical Specifications<a class="anchor" aria-label="anchor" href="#appendix-1---metadata-technical-specifications"></a>
</h2>
<p>{gsm} has several standardized metadata models that are used to facilitate a standardized, reusable workflow for RBM. The default metadata used by {gsm} are stored as YAML files in the <code>inst</code> folder, and can be customized for any given study.</p>
<p>Detailed specifications for each type of metadata is provided below, and example data for the AE domain is provided.</p>
<div class="section level3">
<h3 id="data-specification-metadata">Data Specification Metadata<a class="anchor" aria-label="anchor" href="#data-specification-metadata"></a>
</h3>
<p>Input data specifications define the data requirements for a given {gsm} function and are saved in <code>inst/specs</code>.</p>
<p>Each input data specification lists the data domains required for the function and specifies the following parameters for each domain:</p>
<ul>
<li>
<code>vRequired</code> - list of parameters that should be defined in <code>mapping</code> (see more details in the following section).</li>
<li>
<code>vUniqueCols</code> - list of column parameters that should not contain duplicate values</li>
<li>
<code>vNACols</code> - list of column parameters where NA and empty string values are acceptable.</li>
</ul>
<p>The specification for the AE mapping function (<code>inst/specs/AE_Map_Raw.yaml</code>) is shown below:</p>
<pre><code><span><span class="va">dfAE</span><span class="op">:</span></span>
<span>  <span class="va">vRequired</span><span class="op">:</span></span>
<span>    <span class="op">-</span> <span class="va">strIDCol</span></span>
<span><span class="va">dfSUBJ</span><span class="op">:</span></span>
<span>  <span class="va">vRequired</span><span class="op">:</span></span>
<span>    <span class="op">-</span> <span class="va">strIDCol</span></span>
<span>    <span class="op">-</span> <span class="va">strSiteCol</span></span>
<span>    <span class="op">-</span> <span class="va">strTimeOnTreatmentCol</span></span>
<span>  <span class="va">vUniqueCols</span><span class="op">:</span></span>
<span>    <span class="op">-</span> <span class="va">strIDCol</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="data-mappings-metadata">Data Mappings Metadata<a class="anchor" aria-label="anchor" href="#data-mappings-metadata"></a>
</h3>
<p>Mapping Specifications in {gsm} define a “mapping” of column and field-level inputs needed for a function. This mapping can be used in combination with a specification to confirm that input data meets the requirements for a function.</p>
<p>Each mapping object lists the required parameters for all required data domains and specifies the column and field values for specific data sets.</p>
<p>For example, the following could be passed to the <code>mapping</code> parameter for the <code><a href="../reference/AE_Map_Raw.html">AE_Map_Raw()</a></code> function to be used with the default data from <code><a href="https://rdrr.io/pkg/clindata/man/rawplus_ae.html" class="external-link">clindata::rawplus_ae</a></code> and <code><a href="https://rdrr.io/pkg/clindata/man/rawplus_dm.html" class="external-link">clindata::rawplus_dm</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  dfAE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>strIDCol <span class="op">=</span> <span class="st">'SubjectID'</span><span class="op">)</span>,</span>
<span>  dfSUBJ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    strIDCol <span class="op">=</span> <span class="st">'SubjectID'</span>,</span>
<span>    strSiteCol <span class="op">=</span> <span class="st">'SiteID'</span>,</span>
<span>    strTimeOnTreatmentCol <span class="op">=</span> <span class="st">'TimeOnTreatment'</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that <code><a href="../reference/Study_Assess.html">Study_Assess()</a></code> is designed to share a <code>mapping</code> object across multiple assessments. The default mapping is saved as a YAML file (<code>inst/mappings/mapping_rawplus.yaml</code>), but users can also create a custom mapping object for their use cases by making a custom YAML file, or by creating or modifying a <code>list</code> like that returned by <code>yaml::read_yaml(system.file("mappings", "mapping_rawplus.yaml", package = "gsm"))</code>.</p>
</div>
<div class="section level3">
<h3 id="assessment-workflow-metadata">Assessment Workflow Metadata<a class="anchor" aria-label="anchor" href="#assessment-workflow-metadata"></a>
</h3>
<p>Assessment Workflow Metadata objects are passed to the <code>lAssessments</code> parameter in <code><a href="../reference/Study_Assess.html">Study_Assess()</a></code> to define functions and parameters (including <code>mappings</code> and <code>specs</code>) across multiple studies.</p>
<p>The <code>lAssessment</code> object is a named list of metadata defining how each assessment should be run. By default, <code><a href="../reference/MakeAssessmentList.html">MakeAssessmentList()</a></code> imports YAML specifications from <code>inst/assessments</code>. Each item in <code>lAssessments</code> expects the following parameters.</p>
<ul>
<li>
<code>workflow</code>: Array defining one or more functions to be executed as part of the workflow for a given assessment.
<ul>
<li>
<code>workflow[]$name</code>: name of the {gsm} function.</li>
<li>
<code>workflow[]$inputs</code>: Specifies the required input data.</li>
<li>
<code>workflow[]$output</code>: Specifies the output data from the workflow step; can be used as an input in the next step in the workflow.</li>
<li>
<code>workflow[]$params</code>: Specifies parameters to be passed to the function.</li>
</ul>
</li>
</ul>
<p>For example, the workflow for the AE assessment (<code>inst/assessments/ae.yaml</code>) is shown below:</p>
<pre><code><span><span class="va">workflow</span><span class="op">:</span></span>
<span>  <span class="op">-</span> <span class="va">name</span><span class="op">:</span> <span class="va">FilterDomain</span></span>
<span>    <span class="va">inputs</span><span class="op">:</span> <span class="va">dfAE</span></span>
<span>    <span class="va">output</span><span class="op">:</span> <span class="va">dfAE</span></span>
<span>    <span class="va">params</span><span class="op">:</span></span>
<span>      <span class="va">strDomain</span><span class="op">:</span> <span class="va">dfAE</span></span>
<span>      <span class="va">strColParam</span><span class="op">:</span> <span class="va">strTreatmentEmergentCol</span></span>
<span>      <span class="va">strValParam</span><span class="op">:</span> <span class="va">strTreatmentEmergentVal</span></span>
<span>  <span class="op">-</span> <span class="va">name</span><span class="op">:</span> <span class="va">AE_Map_Raw</span></span>
<span>    <span class="va">inputs</span><span class="op">:</span> </span>
<span>      <span class="op">-</span> <span class="va">dfAE</span></span>
<span>      <span class="op">-</span> <span class="va">dfSUBJ</span></span>
<span>    <span class="va">output</span><span class="op">:</span> <span class="va">dfInput</span></span>
<span>  <span class="op">-</span> <span class="va">name</span><span class="op">:</span> <span class="va">AE_Assess</span></span>
<span>    <span class="va">inputs</span><span class="op">:</span> <span class="va">dfInput</span></span>
<span>    <span class="va">output</span><span class="op">:</span> <span class="va">lResults</span></span>
<span>    <span class="va">params</span><span class="op">:</span></span>
<span>      <span class="va">strMethod</span><span class="op">:</span> <span class="st">"poisson"</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by George Wu, Jeremy Wildfire, Matt Roumaya, Nathan Kosiba, Douglas Sanders, Spencer Childress, Li Ge, Colleen McLaughlin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
