<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data Pipeline • gsm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data Pipeline">
<meta property="og:description" content="gsm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ContributorGuidelines.html">Contributor Guidelines</a>
    </li>
    <li>
      <a href="../articles/Cookbook.html">Cookbook</a>
    </li>
    <li>
      <a href="../articles/DataPipeline.html">Data Pipeline</a>
    </li>
    <li>
      <a href="../articles/Qualification.html">Qualification of GSM</a>
    </li>
    <li>
      <a href="../articles/QualificationWorkflow.html">Qualification Workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Gilead-BioStats/gsm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="DataPipeline_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data Pipeline</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/gsm/blob/HEAD/vignettes/DataPipeline.Rmd" class="external-link"><code>vignettes/DataPipeline.Rmd</code></a></small>
      <div class="hidden name"><code>DataPipeline.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>The {gsm} package provides a standardized workflow that leverages Key Risk Indicators (KRIs) and thresholds to conduct study-level Risk Based Monitoring (RBM) for clinical trials. This vignette provides an overview of the {gsm} data model. First, we provide an overview of standardized data pipeline used to calculate KRIs and evaluate thresholds to set site-level flags. We also discuss workflows and reports that allow users to run multiple KRIs concurrently on a study.</p>
</div>
<div class="section level2">
<h2 id="kri-data-pipeline">KRI Data Pipeline<a class="anchor" aria-label="anchor" href="#kri-data-pipeline"></a>
</h2>
<p><img width="862" alt="image" src="https://user-images.githubusercontent.com/3680095/169086356-e31ab9a5-c709-46cf-9bd9-68b7bdbba72b.png"></p>
<p>In the context of clinical research a KRI is a measure of risk associated with the conduct of a clinical trial. Examples of KRIs include the rate of adverse events or amount of missing data at a site or across sites. Defining and deploying KRIs during study start-up allows sponsors to continually monitor risks to the integrity of the trial and take corrective actions accordingly.</p>
<p>The KRI data pipeline begins with one or more clinical datasets related to the KRI. An optional participant-level subset is then applied to each dataset before aggregating by participant to quantify the KRI at the participant level. This aggregated dataset is then further summarized by site to obtain site-level metrics.</p>
<div class="section level3">
<h3 id="assessment-data-pipeline">Assessment Data Pipeline<a class="anchor" aria-label="anchor" href="#assessment-data-pipeline"></a>
</h3>
<p><img width="862" alt="image" src="https://user-images.githubusercontent.com/3680095/157536920-81fa77b1-2ded-4e5b-8915-07537c1fb8d5.png"></p>
<p>The image above provides an overview of the KRI assessment pipeline. The pipeline is a standardized four-step process for <strong>assessing</strong> data issues by going from participant-level <code>input</code> data to a standardized site-level <code>summary</code> of model results. The functions used in each step of the data pipeline along with the input and output datasets are described in more detail below.</p>
<ol style="list-style-type: decimal">
<li>
<code>input</code> data - Cross-domain participant-level input data with all needed data for KRI derivation.</li>
<li>
<code>transformed</code> data - Site-level transformed data including KRI calculation. Created by <code>Transform</code> functions.</li>
<li>
<code>analyzed</code> data - Site-level analysis result data. Created by <code>Analyze</code> functions.</li>
<li>
<code>flagged</code> data - Site-level analysis results with flags added. Created by passing numeric <code>thresholds</code> to a <code>Flag</code> function.</li>
<li>
<code>summary</code> data - Standardized subset the flagged data. This summary data has the same structure for all assessments and always includes both <code>KRI</code> and <code>Flag</code> values so that we can easily look at trends for any given site across multiple assessments. Created using a <code>Summarize</code> Function.</li>
</ol>
<p>Finally, each assessment has an <code>Assess</code> function that sequentially executes all 4 of the functions and returns a list containing all 5 data sets listed above.</p>
</div>
<div class="section level3">
<h3 id="generating-input-data">Generating <code>input</code> data<a class="anchor" aria-label="anchor" href="#generating-input-data"></a>
</h3>
<p>Creating input data is outside the scope of the assessment pipeline. The specifications for <code>input</code> data are designed so that the data can easily be generated from multiple clinical data standards (e.g. Raw, ADaM or SDTM). Most assessments have <code>Map</code> functions that can be used to generate <code>input</code> data. For example, the Adverse Event assessment has 2 map functions, <code><a href="../reference/AE_Map_Raw.html">AE_Map_Raw()</a></code> and <code><a href="../reference/AE_Map_Adam.html">AE_Map_Adam()</a></code> which create <code>input</code> data from Raw and ADaM data respectively.</p>
<p>These <code>map</code> functions are provided for convenience but may not work for all clinical studies. When no <code>map</code> function is available for a given assessment, the user is expected to manually create <code>input</code> data following the specifications for that assessment.</p>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="metadata-technical-specifications">Metadata Technical Specifications<a class="anchor" aria-label="anchor" href="#metadata-technical-specifications"></a>
</h3>
<p>Running multiple assessments in {gsm} involves a number of YAML files that provide metadata to orchestrate the workflow that is triggered by <code><a href="../reference/Study_Assess.html">Study_Assess()</a></code>. The YAML file for any given assessment provides expected values for the names of input data, required columns, column properties (e.g. unique values or non-missing values), and optionally one or more subsets.</p>
<p>Below is an overview of each YAML specification for the Adverse Events assessment.</p>
<div class="section level4">
<h4 id="assessment-specification">Assessment Specification<a class="anchor" aria-label="anchor" href="#assessment-specification"></a>
</h4>
<p>Below is an example assessment specification in YAML format for the Adverse Events assessment, as well as a nested list describing the required metadata that can be customized as needed.</p>
<ul>
<li>
<code>label</code>: Label used to describe the assessment, in this case “Treatment-Emergent Adverse Events”</li>
<li>
<code>tags</code>: Labels to be appended as a column to summary data. The first value will be the column name, and the second value will be the row value for all rows in the summary data.
<ul>
<li>
<code>Assessment</code>: Creates a column “Assessment” with the value “Safety” in the summary data.</li>
<li>
<code>Label</code>: Creates a column “Label” with the value “AEs” in the summary data.</li>
</ul>
</li>
<li>
<code>workflow</code>: The workflow specification begins the steps in a given assessment.
<ul>
<li>
<code>-name</code>: Initiates the {gsm} function FilterDomain().</li>
<li>
<code>inputs</code>: Specifies the required input data for FilterDomain().</li>
<li>
<code>output</code>: Specifies the required output data for FilterDomain() to be used as input data in the next step in the workflow.</li>
<li>
<code>params</code>: Specifies parameters to be passed to FilterDomain().
<ul>
<li>
<code>strDomain</code>: Specifies the domain that will be filtered.</li>
<li>
<code>strColParam</code>: Specifies that the strTreatmentEmergentCol will be used to filter dfAE.</li>
<li>
<code>strValParam</code>: Specifies the value that strTreatmentEmergentCol will be filtered on.</li>
</ul>
</li>
<li>
<code>-name</code>: Initiates the {gsm} function AE_Map_Raw().</li>
<li>
<code>inputs</code>: Because AE_Map_Raw() requires two inputs, a colon is used to list multiple inputs.
<ul>
<li>
<code>-dfAE</code>: Specifies event-level data to be used in AE_Map_Raw().</li>
<li>
<code>-dfSUBJ</code>: Specifies subject-level data to be used in AE_Map_Raw().</li>
</ul>
</li>
<li>
<code>output</code>: Specifies the required output data for AE_Map_Raw() to be used as input data in the next step in the workflow.</li>
<li>
<code>-name</code>: Initiates the {gsm} function AE_Assess().</li>
<li>
<code>inputs</code>: Specifies the required input data for AE_Assess().</li>
<li>
<code>output</code>: Specifies the required output data for AE_Assess().</li>
<li>
<code>params</code>: Specifies parameters to be passed to AE_Assess().
<ul>
<li>
<code>strMethod</code>: Specifies that a Poisson model will be used in AE_Assess().</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>The nested list (above) describes the Assessment YAML mapping (below).</strong></p>
<pre><code>label: Treatment-Emergent Adverse Events
tags:
  Assessment: Safety
  Label: AEs
workflow:
  - name: FilterDomain
    inputs: dfAE
    output: dfAE
    params:
      strDomain: dfAE
      strColParam: strTreatmentEmergentCol
      strValParam: strTreatmentEmergentVal
  - name: AE_Map_Raw
    inputs: 
      - dfAE
      - dfSUBJ
    output: dfInput
  - name: AE_Assess
    inputs: dfInput
    output: lResults
    params:
      strMethod: "poisson"</code></pre>
</div>
<div class="section level4">
<h4 id="mapping-specification">Mapping Specification<a class="anchor" aria-label="anchor" href="#mapping-specification"></a>
</h4>
<p>Below is an example mapping specification in YAML format for the Adverse Events assessment, as well as a nested list describing the required metadata.</p>
<ul>
<li>
<code>dfInput</code>: Top-level description that specifies the name of the required input for <code><a href="../reference/AE_Assess.html">AE_Assess()</a></code>
<ul>
<li>
<code>strIDCol</code>: Specifies that the ID column is named <code>SubjectID</code>
</li>
<li>
<code>strSiteCol</code>: Specifies that the Site ID column is named <code>SiteID</code>
</li>
<li>
<code>strCountCol</code>: Specifies that the Count column is named <code>Count</code>
</li>
<li>
<code>strExposureCol</code>: Specifies that the Exposure column is named <code>Exposure</code>
</li>
<li>
<code>strRateCol</code>: Specifies that the Rate column is named <code>Rate</code>
</li>
</ul>
</li>
</ul>
<p><strong>The nested list (above) describes the Mapping YAML mapping (below).</strong></p>
<pre><code><span class="va">dfInput</span><span class="op">:</span>
  <span class="va">strIDCol</span><span class="op">:</span> <span class="st">"SubjectID"</span>
  <span class="va">strSiteCol</span><span class="op">:</span> <span class="st">"SiteID"</span>
  <span class="va">strCountCol</span><span class="op">:</span> <span class="st">"Count"</span>
  <span class="va">strExposureCol</span><span class="op">:</span> <span class="st">"Exposure"</span>
  <span class="va">strRateCol</span><span class="op">:</span> <span class="st">"Rate"</span></code></pre>
</div>
<div class="section level4">
<h4 id="input-data-specification">Input Data Specification<a class="anchor" aria-label="anchor" href="#input-data-specification"></a>
</h4>
<p>Below is an example input data specification in YAML format for the Adverse Events assessment, as well as a nested list describing the required metadata that can be customized as needed.</p>
<ul>
<li>
<code>dfInput</code>: Top-level description that specifies the name of the required input for <code><a href="../reference/AE_Assess.html">AE_Assess()</a></code>.
<ul>
<li>
<code>vRequired</code>: Specifies required columns for <code>dfInput</code> in the <code><a href="../reference/AE_Assess.html">AE_Assess()</a></code> function.
<ul>
<li>
<code>- "strIDCol"</code>: Notes that strIDCol is required. The column name for strIDCol is specified in the Mapping YAML file.</li>
<li>
<code>- "strSiteCol"</code>: Notes that strSiteCol is required. The column name for strSiteCol is specified in the Mapping YAML file.</li>
<li>
<code>- "strCountCol"</code>: Notes that strCountCol is required. The column name for strCountCol is specified in the Mapping YAML file.</li>
<li>
<code>- "strExposureCol"</code>: Notes that strExposureCol is required. The column name for strExposureCol is specified in the Mapping YAML file.</li>
<li>
<code>- "strRateCol"</code>: Notes that strRateCol is required. The column name for strRateCol is specified in the Mapping YAML file.</li>
</ul>
</li>
<li>
<code>vUniqueCols</code>: Specifies columns that must contain unique values for dfInput in the <code><a href="../reference/AE_Assess.html">AE_Assess()</a></code> function.
<ul>
<li>
<code>- "strIDCol"</code>: Notes that strIDCol must contain unique values. The column name for strIDCol is specified in the Mapping YAML file.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>The nested list (above) describes the Input Data YAML mapping (below).</strong></p>
<pre><code><span class="va">dfInput</span><span class="op">:</span>
  <span class="va">vRequired</span><span class="op">:</span>
    <span class="op">-</span> <span class="st">"strIDCol"</span>
    <span class="op">-</span> <span class="st">"strSiteCol"</span>
    <span class="op">-</span> <span class="st">"strCountCol"</span>
    <span class="op">-</span> <span class="st">"strExposureCol"</span>
    <span class="op">-</span> <span class="st">"strRateCol"</span>
  <span class="va">vUniqueCols</span><span class="op">:</span>
    <span class="op">-</span> <span class="st">"strIDCol"</span></code></pre>
</div>
<div class="section level4">
<h4 id="supported-assessment-mapping">Supported Assessment Mapping<a class="anchor" aria-label="anchor" href="#supported-assessment-mapping"></a>
</h4>
<p>In addition to the specific mapping for Adverse Events above, the {clindata} package contains a YAML mapping that is converted to a list for all supported assessments in {gsm}, with key-value pairs for required columns.</p>
<p><code>clindata::mapping_rawplus</code> provides the default mapping passed to <code>lMapping</code> in the <code><a href="../reference/Study_Assess.html">gsm::Study_Assess</a></code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lMapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  dfSUBJ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    strIDCol <span class="op">=</span> <span class="st">"SubjectID"</span>,
    strSiteCol <span class="op">=</span> <span class="st">"SiteID"</span>,
    strTimeOnTreatmentCol <span class="op">=</span> <span class="st">"TimeOnTreatment"</span>,
    strTimeOnStudyCol <span class="op">=</span> <span class="st">"TimeOnStudy"</span>,
    strRandFlagCol <span class="op">=</span> <span class="st">"RandFlag"</span>,
    strRandDateCol <span class="op">=</span> <span class="st">"RandDate"</span>,
    strStudyCompletionFlagCol <span class="op">=</span> <span class="st">"StudCompletion"</span>,
    strStudyDiscontinuationReasonCol <span class="op">=</span> <span class="st">"StudDCReason"</span>,
    strTreatmentCompletionFlagCol <span class="op">=</span> <span class="st">"TrtCompletion"</span>,
    strTreatmentDiscontinuationReasonCol <span class="op">=</span> <span class="st">"TrtDCReason"</span>
  <span class="op">)</span>,
  dfAE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    strIDCol <span class="op">=</span> <span class="st">"SubjectID"</span>,
    strTreatmentEmergentCol <span class="op">=</span> <span class="st">"AE_TE_FLAG"</span>,
    strTreatmentEmergentVal <span class="op">=</span> <span class="cn">TRUE</span>,
    strGradeCol <span class="op">=</span> <span class="st">"AE_GRADE"</span>,
    strSeriousCol <span class="op">=</span> <span class="st">"AE_SERIOUS"</span>,
    strSeriousVal <span class="op">=</span> <span class="st">"Yes"</span>
  <span class="op">)</span>,
  dfPD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    strIDCol <span class="op">=</span> <span class="st">"SubjectID"</span>,
    strCategoryCol <span class="op">=</span> <span class="st">"PD_CATEGORY"</span>,
    strImportantCol <span class="op">=</span> <span class="st">"PD_IMPORTANT_FLAG"</span>,
    strImportantVal <span class="op">=</span> <span class="st">"Y"</span>
  <span class="op">)</span>,
  dfIE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    strIDCol <span class="op">=</span> <span class="st">"SubjectID"</span>,
    strCategoryCol <span class="op">=</span> <span class="st">"IE_CATEGORY"</span>,
    strValueCol <span class="op">=</span> <span class="st">"IE_VALUE"</span>,
    strVersionCol <span class="op">=</span> <span class="st">"IE_PROTOCOLVERSION"</span>,
    vCategoryValues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EXCL"</span>, <span class="st">"INCL"</span><span class="op">)</span>,
    vExpectedResultValues <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>
  <span class="op">)</span>,
  dfCONSENT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    strIDCol <span class="op">=</span> <span class="st">"SubjectID"</span>,
    strTypeCol <span class="op">=</span> <span class="st">"CONSENT_TYPE"</span>,
    strValueCol <span class="op">=</span> <span class="st">"CONSENT_VALUE"</span>,
    strDateCol <span class="op">=</span> <span class="st">"CONSENT_DATE"</span>,
    strConsentTypeValue <span class="op">=</span> <span class="st">"MAINCONSENT"</span>,
    strConsentStatusValue <span class="op">=</span> <span class="st">"Y"</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by George Wu, Jeremy Wildfire, Matt Roumaya, Nathan Kosiba, Douglas Sanders, Spencer Childress.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
