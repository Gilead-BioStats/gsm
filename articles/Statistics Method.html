<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Statistics Method • gsm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Statistics Method">
<meta property="og:description" content="gsm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cookbook.html">Cookbook</a>
    </li>
    <li>
      <a href="../articles/DataAnalysis.html">Step-by-Step Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/DataPipeline.html">Data Pipeline</a>
    </li>
    <li>
      <a href="../articles/ContributorGuidelines.html">Contributor Guidelines</a>
    </li>
    <li>
      <a href="../articles/Qualification.html">Qualification of {gsm}</a>
    </li>
    <li>
      <a href="../articles/QualificationWorkflow.html">Qualification Workflow</a>
    </li>
    <li>
      <a href="../articles/Statistics%20Method.html">Statistics Method</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Gilead-BioStats/gsm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Statistics%20Method_files/htmlwidgets-1.6.1/htmlwidgets.js"></script><link href="Statistics%20Method_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="Statistics%20Method_files/datatables-binding-0.27/datatables.js"></script><link href="Statistics%20Method_files/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="Statistics%20Method_files/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="Statistics%20Method_files/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="Statistics%20Method_files/dt-ext-fixedcolumns-1.12.1/css/fixedColumns.dataTables.min.css" rel="stylesheet">
<script src="Statistics%20Method_files/dt-ext-fixedcolumns-1.12.1/js/dataTables.fixedColumns.min.js"></script><link href="Statistics%20Method_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="Statistics%20Method_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Statistics Method</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/gsm/blob/HEAD/vignettes/articles/Statistics%20Method.Rmd" class="external-link"><code>vignettes/articles/Statistics Method.Rmd</code></a></small>
      <div class="hidden name"><code>Statistics Method.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This page outlines the statistical methods of <a href="https://github.com/Gilead-BioStats/gsm" class="external-link">gsm</a>.
Based on the type of the KRIs (binary outcome or count outcome), the
statistical methods include Identity, Fisher, Poisson, Normal
Approximation.</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The assessment of each KRI in <a href="https://github.com/Gilead-BioStats/gsm" class="external-link">gsm</a> is either a
percentage of a binary outcome (e.g. proportion of patients discontinued
treatment in the disposition assessment) or a rate of a count outcome
(e.g. rate of AE events over a period of exposure time).
<a href="https://github.com/Gilead-BioStats/gsm" class="external-link">gsm</a> can apply corresponding statistical methods:</p>
<ul>
<li>
<strong>binary outcome</strong> - <code>Identity</code>,
<code>Fisher</code>, <code>NormalApprox</code>
</li>
<li>
<strong>rate outcome</strong> - <code>Identity</code>,
<code>Poisson</code>, <code>NormalApprox</code>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="the-identity-method">1. The Identity Method<a class="anchor" aria-label="anchor" href="#the-identity-method"></a>
</h2>
<p>Identity method uses the KRI itself as the metric (score).</p>
</div>
<div class="section level2">
<h2 id="the-fishers-exact-method">2. The Fisher’s Exact Method<a class="anchor" aria-label="anchor" href="#the-fishers-exact-method"></a>
</h2>
<div class="section level3">
<h3 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h3>
<p>Fisher’s exact test is a statistical significance test used in the
analysis of contingency tables when you have nominal variables and want
to find out if proportions for one variable are different among values
of the other variables.</p>
<p>In contrast to large-sample based statistics which rely on
approximation, Fisher’s exact test can be applied when sample sizes are
small.</p>
<p>The function <code>Analyze_Fisher</code> utilizes
<code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">stats::fisher.test</a></code> to generate an estimate of odds ratio as
well as p-value using the Fisher’s exact test with site-level count
data. For each site, Fisher’s exact test is conducted by comparing to
all other sites combined in a 2×2 contingency table. The p-values are
then used as a scoring metric in <a href="https://github.com/Gilead-BioStats/gsm" class="external-link">gsm</a> to flag possible
outliers. The default in <code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">stats::fisher.test</a></code> uses a
two-sided test (equivalent to testing the null of OR = 1) and does not
compute p-values by Monte Carlo simulation unless
<code>simulate.p.value = TRUE</code>. Sites with p-values less than 0.05
from the Fisher’s exact test analysis are flagged by default. The
significance level was set at a common choice.</p>
</div>
<div class="section level3">
<h3 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h3>
<p>For example, in a <span class="math inline">\(2 \times 2\)</span>
contingency table, the two rows are considered repeated Bernoulli random
samples with same probability <span class="math inline">\(p=0.5\)</span>
of success or failure under the null. Given a <span class="math inline">\(2 \times 2\)</span> contingency table,</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Group1</th>
<th align="left">Group2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Condition1</td>
<td align="left">a</td>
<td align="left">c</td>
</tr>
<tr class="even">
<td align="left">Condition2</td>
<td align="left">b</td>
<td align="left">d</td>
</tr>
</tbody>
</table>
<p>Fisher (1922) showed that conditional on the margins of the table,
<span class="math inline">\(a\)</span> is distributed as an
hypergeometric distribution with <span class="math inline">\(a+c\)</span> draws from a population with <span class="math inline">\(a+b\)</span> successes and <span class="math inline">\(c+d\)</span> failures. Let <span class="math inline">\(n=a+b+c+d\)</span>, the probability of obtaining
such set of values is given by: <span class="math display">\[
p=\frac{{{a+b} \choose a} {{c+d} \choose c}}{{n \choose
{a+c}}}=\frac{{{a+b} \choose b} {{c+d} \choose d}}{{n \choose
{b+d}}}=\frac{(a+b)!(c+d)!(a+c)!(b+d)!}{a! b! c! d! n!}.
\]</span> ## <span class="math inline">\(m \times n\)</span> contingency
table</p>
<p>In general, consider a <span class="math inline">\(m \times
n\)</span> contingency table with entries <span class="math inline">\(a_{ij}\)</span>, where <span class="math inline">\(i=1, \dots, m\)</span> and <span class="math inline">\(j=1, \dots, n\)</span>. Let <span class="math inline">\(R_i\)</span> and <span class="math inline">\(C_j\)</span> denote the row sum and column sum,
respectively. Then the total <span class="math inline">\(N=\sum_i
R_i=\sum_j C_j\)</span>. The probability of getting the exact
contingency table given the observed row and column sums is given by
<span class="math display">\[
p=\frac{(R_1! R_2!, \dots, R_m!)(C_1! C_2!, \dots, C_n!)}{N!\prod_{i,
j}a_{ij}!}.
\]</span> which is a multivariate version of the hypergeometric
probability function.</p>
</div>
<div class="section level3">
<h3 id="application">Application<a class="anchor" aria-label="anchor" href="#application"></a>
</h3>
<p>An example using the KRI: subject Discontinuation:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfInput</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Disp_Map_Raw.html">Disp_Map_Raw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dfTransformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Transform_Rate.html">Transform_Rate</a></span><span class="op">(</span></span>
<span>  <span class="va">dfInput</span>,</span>
<span>  strGroupCol <span class="op">=</span> <span class="st">"SiteID"</span>,</span>
<span>  strNumeratorCol <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>  strDenominatorCol <span class="op">=</span> <span class="st">"Total"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dfAnalyzed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Analyze_Fisher.html">Analyze_Fisher</a></span><span class="op">(</span><span class="va">dfTransformed</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfFlagged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Flag_Fisher.html">Flag_Fisher</a></span><span class="op">(</span><span class="va">dfAnalyzed</span>, vThreshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">dfFlagged</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-117aad5c00fc225498ba" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-117aad5c00fc225498ba">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["60","161","28","26","115","52","13","77","15","145","154","159","165","175","48","174","89","189","166","114","190","8","139","34","5","182","185","3","46","104","43","71","116","130","16","168","25","40","53","67","124","144","179","39","64","81","127","128","135","184","186","118","134","131","157","29","83","143","172","50","59","94","4","155","63","75","141","17","85","91","140","10","58","56","170","100","11","111","112","113","119","121","122","129","136","137","138","146","148","149","150","152","156","160","162","164","178","18","183","30","41","57","7","82","9","98","101","102","103","105","106","107","109","120","133","142","147","151","153","163","167","173","176","177","181","187","188","19","22","23","27","32","35","44","47","49","51","54","61","62","68","69","70","73","76","80","84","86","92","96","97","110","117","12","123","126","132","14","158","171","180","20","31","33","36","38","42","45","55","6","65","66","72","78","87","99"],[3,3,3,3,2,2,3,4,2,1,1,1,1,1,1,2,2,0,4,2,2,0,2,2,1,1,1,1,1,2,5,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,2,1,0,0,0,0,0,0,2,5,2,2,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,3,0,1,0,0,1,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[119,119,119,119,120,120,119,118,120,121,121,121,121,121,121,120,120,122,118,120,120,122,120,120,121,121,121,121,121,120,117,120,121,121,121,121,121,121,121,120,121,121,121,121,121,121,121,121,121,121,121,122,121,121,121,121,121,121,121,121,121,120,121,122,122,122,122,122,122,120,117,120,120,121,119,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,121,120,122,122,122,122,122,122,122,122,122,122,122,122,122,122,121,121,121,119,122,121,122,122,121,122,122,120,121,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122],[4,5,5,7,3,3,8,17,5,1,1,1,1,1,1,6,6,28,20,7,7,23,58,8,43,2,2,2,2,9,33,10,3,3,3,3,3,3,3,11,4,4,4,4,4,4,5,5,5,5,5,17,6,7,7,7,7,28,28,8,8,36,9,10,10,10,12,12,13,16,69,20,20,25,27,2,9,2,2,8,2,6,9,2,2,7,6,7,2,8,2,6,9,7,2,7,2,2,2,7,2,2,9,2,2,2,3,3,4,3,3,3,4,3,5,4,5,3,4,3,15,27,5,5,3,5,3,3,5,5,4,3,5,4,3,4,11,17,15,34,4,12,3,4,12,5,3,22,15,4,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1297,1296,1296,1294,1298,1298,1293,1284,1296,1300,1300,1300,1300,1300,1300,1295,1295,1273,1281,1294,1294,1278,1243,1293,1258,1299,1299,1299,1299,1292,1268,1291,1298,1298,1298,1298,1298,1298,1298,1290,1297,1297,1297,1297,1297,1297,1296,1296,1296,1296,1296,1284,1295,1294,1294,1294,1294,1273,1273,1293,1293,1265,1292,1291,1291,1291,1289,1289,1288,1285,1232,1281,1281,1276,1274,1299,1292,1299,1299,1293,1299,1295,1292,1299,1299,1294,1295,1294,1299,1293,1299,1295,1292,1294,1299,1294,1299,1299,1299,1294,1299,1299,1292,1299,1299,1299,1298,1298,1297,1298,1298,1298,1297,1298,1296,1297,1296,1298,1297,1298,1286,1274,1296,1296,1298,1296,1298,1298,1296,1296,1297,1298,1296,1297,1298,1297,1290,1284,1286,1267,1297,1289,1298,1297,1289,1296,1298,1279,1286,1297,1296,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300,1300],[0.75,0.6,0.6,0.428571428571429,0.666666666666667,0.666666666666667,0.375,0.235294117647059,0.4,1,1,1,1,1,1,0.333333333333333,0.333333333333333,0,0.2,0.285714285714286,0.285714285714286,0,0.0344827586206897,0.25,0.0232558139534884,0.5,0.5,0.5,0.5,0.222222222222222,0.151515151515152,0.2,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.181818181818182,0.25,0.25,0.25,0.25,0.25,0.25,0.2,0.2,0.2,0.2,0.2,0,0.166666666666667,0.142857142857143,0.142857142857143,0.142857142857143,0.142857142857143,0.0357142857142857,0.0357142857142857,0.125,0.125,0.0555555555555556,0.111111111111111,0,0,0,0,0,0,0.125,0.072463768115942,0.1,0.1,0.04,0.111111111111111,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0666666666666667,0.0740740740740741,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0909090909090909,0.0588235294117647,0.0666666666666667,0.0882352941176471,0,0.0833333333333333,0,0,0.0833333333333333,0,0,0.0909090909090909,0.0666666666666667,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0.0917501927525058,0.091820987654321,0.091820987654321,0.0919629057187017,0.0924499229583975,0.0924499229583975,0.0920340293890178,0.0919003115264797,0.0925925925925926,0.0930769230769231,0.0930769230769231,0.0930769230769231,0.0930769230769231,0.0930769230769231,0.0930769230769231,0.0926640926640927,0.0926640926640927,0.0958366064414768,0.0921155347384856,0.0927357032457496,0.0927357032457496,0.0954616588419405,0.0965406275140788,0.0928074245939675,0.0961844197138315,0.0931485758275597,0.0931485758275597,0.0931485758275597,0.0931485758275597,0.0928792569659443,0.0922712933753943,0.0929512006196747,0.0932203389830508,0.0932203389830508,0.0932203389830508,0.0932203389830508,0.0932203389830508,0.0932203389830508,0.0932203389830508,0.0930232558139535,0.0932922127987664,0.0932922127987664,0.0932922127987664,0.0932922127987664,0.0932922127987664,0.0932922127987664,0.0933641975308642,0.0933641975308642,0.0933641975308642,0.0933641975308642,0.0933641975308642,0.0950155763239875,0.0934362934362934,0.0935085007727975,0.0935085007727975,0.0935085007727975,0.0935085007727975,0.0950510604870385,0.0950510604870385,0.0935808197989172,0.0935808197989172,0.0948616600790514,0.0936532507739938,0.0945003872966692,0.0945003872966692,0.0945003872966692,0.0946470131885182,0.0946470131885182,0.0947204968944099,0.0933852140077821,0.0949675324675325,0.0936768149882904,0.0936768149882904,0.0948275862068965,0.0934065934065934,0.0939183987682833,0.0944272445820433,0.0939183987682833,0.0939183987682833,0.094354215003867,0.0939183987682833,0.0942084942084942,0.0944272445820433,0.0939183987682833,0.0939183987682833,0.0942812982998454,0.0942084942084942,0.0942812982998454,0.0939183987682833,0.094354215003867,0.0939183987682833,0.0942084942084942,0.0944272445820433,0.0942812982998454,0.0939183987682833,0.0942812982998454,0.0939183987682833,0.0939183987682833,0.0939183987682833,0.0942812982998454,0.0939183987682833,0.0939183987682833,0.0944272445820433,0.0939183987682833,0.0939183987682833,0.0939183987682833,0.0939907550077042,0.0939907550077042,0.0940632228218967,0.0939907550077042,0.0939907550077042,0.0939907550077042,0.0940632228218967,0.0939907550077042,0.0941358024691358,0.0940632228218967,0.0941358024691358,0.0939907550077042,0.0940632228218967,0.0939907550077042,0.0940902021772939,0.0941915227629513,0.0941358024691358,0.0941358024691358,0.0939907550077042,0.0941358024691358,0.0939907550077042,0.0939907550077042,0.0941358024691358,0.0941358024691358,0.0940632228218967,0.0939907550077042,0.0941358024691358,0.0940632228218967,0.0939907550077042,0.0940632228218967,0.0937984496124031,0.0942367601246106,0.0940902021772939,0.0939226519337017,0.0940632228218967,0.0938712179984484,0.0939907550077042,0.0940632228218967,0.0938712179984484,0.0941358024691358,0.0939907550077042,0.0938232994526974,0.0940902021772939,0.0940632228218967,0.0941358024691358,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538,0.0938461538461538],[0.75,0.6,0.6,0.428571428571429,0.666666666666667,0.666666666666667,0.375,0.235294117647059,0.4,1,1,1,1,1,1,0.333333333333333,0.333333333333333,0,0.2,0.285714285714286,0.285714285714286,0,0.0344827586206897,0.25,0.0232558139534884,0.5,0.5,0.5,0.5,0.222222222222222,0.151515151515152,0.2,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.181818181818182,0.25,0.25,0.25,0.25,0.25,0.25,0.2,0.2,0.2,0.2,0.2,0,0.166666666666667,0.142857142857143,0.142857142857143,0.142857142857143,0.142857142857143,0.0357142857142857,0.0357142857142857,0.125,0.125,0.0555555555555556,0.111111111111111,0,0,0,0,0,0,0.125,0.072463768115942,0.1,0.1,0.04,0.111111111111111,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0666666666666667,0.0740740740740741,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0909090909090909,0.0588235294117647,0.0666666666666667,0.0882352941176471,0,0.0833333333333333,0,0,0.0833333333333333,0,0,0.0909090909090909,0.0666666666666667,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[29.5164333286901,14.7612313874652,14.7612313874652,7.38416594084536,19.5308227203631,19.5308227203631,5.90362984843157,3.03621108592228,6.51491762808554,null,null,null,null,null,null,4.88519234031765,4.88519234031765,0,2.46157428213679,3.90613079425014,3.90613079425014,0,0.334413823621031,3.25368993693407,0.223878627708572,9.69968353547496,9.69968353547496,9.69968353547496,9.69968353547496,2.78718329594856,1.75577019118909,2.43722879719497,4.85311653453349,4.85311653453349,4.85311653453349,4.85311653453349,4.85311653453349,4.85311653453349,4.85311653453349,2.16492561934184,3.23507165765073,3.23507165765073,3.23507165765073,3.23507165765073,3.23507165765073,3.23507165765073,2.4254178001529,2.4254178001529,2.4254178001529,2.4254178001529,2.4254178001529,0,1.93927453936279,1.61496976646442,1.61496976646442,1.61496976646442,1.61496976646442,0.3528063394396,0.3528063394396,1.38330718001394,1.38330718001394,0.561474541109847,1.20951876484897,0,0,0,0,0,0,1.38650160669692,0.744676523142842,1.07496675900767,1.07496675900767,0.397924451271522,1.21304011957701,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.687901384334394,0.7694933220724,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.966139922881944,0.60091579652097,0.687901384334394,0.933629170498272,0,0.877607756229157,0,0,0.877607756229157,0,0,0.965857568266108,0.687901384334394,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0.00300343635283537,0.00699453373359049,0.00699453373359049,0.0212644769177056,0.0245719917813339,0.0245719917813339,0.0317254714171258,0.0670432338980361,0.0722378895273257,0.0937740199846249,0.0937740199846249,0.0937740199846249,0.0937740199846249,0.0937740199846249,0.0937740199846249,0.101839041693001,0.101839041693001,0.102015025912743,0.109903281973838,0.13406886760312,0.13406886760312,0.158475393180316,0.162319414626322,0.16818333299845,0.175660020252562,0.178819842724536,0.178819842724536,0.178819842724536,0.178819842724536,0.203552921250554,0.227697147185983,0.239647969323618,0.255943768196129,0.255943768196129,0.255943768196129,0.255943768196129,0.255943768196129,0.255943768196129,0.255943768196129,0.276025713788338,0.325878175191565,0.325878175191565,0.325878175191565,0.325878175191565,0.325878175191565,0.325878175191565,0.389288246607622,0.389288246607622,0.389288246607622,0.389288246607622,0.389288246607622,0.394179544713424,0.446778087590549,0.498896290921785,0.498896290921785,0.498896290921785,0.498896290921785,0.508238616472597,0.508238616472597,0.546140999196546,0.546140999196546,0.570960961245063,0.588964508939797,0.61187051153758,0.61187051153758,0.61187051153758,0.617490429085291,0.617490429085291,0.624513490770044,0.656338468141154,0.673184290422707,0.71091261242686,0.71091261242686,0.72385465769712,0.734843337870138,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>GroupID<\/th>\n      <th>Numerator<\/th>\n      <th>Numerator_Other<\/th>\n      <th>Denominator<\/th>\n      <th>Denominator_Other<\/th>\n      <th>Prop<\/th>\n      <th>Prop_Other<\/th>\n      <th>Metric<\/th>\n      <th>Estimate<\/th>\n      <th>Score<\/th>\n      <th>Flag<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":false,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="estimate-and-score">Estimate and Score<a class="anchor" aria-label="anchor" href="#estimate-and-score"></a>
</h3>
<p>The function <code><a href="../reference/Analyze_Fisher.html">Analyze_Fisher()</a></code> in <a href="https://github.com/Gilead-BioStats/gsm" class="external-link">gsm</a>
utilizes <code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">stats::fisher.test()</a></code> to generate an estimate of
odds ratio as well as p-value using the Fisher’s exact test with
site-level count data. For each site, Fisher’s exact test is conducted
by comparing to all other sites combined in a <span class="math inline">\(2 \times 2\)</span> contingency table. The
p-values are then used as a scoring metric in <a href="https://github.com/Gilead-BioStats/gsm" class="external-link">gsm</a> to flag
possible outliers using the thresholds discussed below. The default in
<code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">stats::fisher.test()</a></code> uses two-sided test (equivalent to
testing the null: OR=1) and not to compute p-values by Monte Carlo
simulation unless <code>simulate.p.value = TRUE</code> is specified.</p>
</div>
<div class="section level3">
<h3 id="threshold">Threshold<a class="anchor" aria-label="anchor" href="#threshold"></a>
</h3>
<p>Sites with p-values less than 0.05 from the Fisher’s exact test
analysis are flagged by default. The significance level was set at a
common choice. However, in different scenarios, the cut-off might need
to be adjusted. (TODO: methods comparison) .</p>
</div>
<div class="section level3">
<h3 id="kri-interpretation">KRI interpretation<a class="anchor" aria-label="anchor" href="#kri-interpretation"></a>
</h3>
<p>TODO.</p>
</div>
<div class="section level3">
<h3 id="the-fishers-exact-test-assumptions">The Fisher’s exact test assumptions<a class="anchor" aria-label="anchor" href="#the-fishers-exact-test-assumptions"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>The row totals and the column totals are both fixed by
design.</p></li>
<li><p>The samples are mutually exclusive and mutually
independent.</p></li>
</ol>
<p>The assumptions can be assessed by the knowledge of data collected.
No assumption check is necessary.</p>
</div>
<div class="section level3">
<h3 id="stopifnot-situations">
<code>STOPIFNOT</code> situations<a class="anchor" aria-label="anchor" href="#stopifnot-situations"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Functionally: where we don’t have required input to run Fishers:
p-value will be set <code>NA</code>.</p></li>
<li><p>Results not interpretable/statistical solid: we don’t want to
flag in certain situations, but we don’t want to stop the pipeline
running. We might want a meaningful warning or output.</p></li>
</ol>
<p>Although in practice, the Fisher’s exact test is usually used when
sample sizes are small (e.g., n&lt;5), it is valid for all sample
sizes.</p>
<p>An observed zero cell is not an issue when using Fisher’s exact test,
however, when the expected cell is zero, it means either the marginal is
zero (meaningless) or there are structural zeros (need to consider
zero-inflated issue: West, L. and Hankin, R. (2008), “Exact Tests for
Two-Way Contingency Tables with Structural Zeros,” Journal of
Statistical Software, 28(11), 1–19). TODO: add more clarification,
example and reference.</p>
</div>
<div class="section level3">
<h3 id="constraints">constraints<a class="anchor" aria-label="anchor" href="#constraints"></a>
</h3>
<p>For small samples, Fisher’s exact test is highly discrete. Fisher’s
exact test is often considered to be more conservative. This may due to
the use a discrete statistic with fixed significance levels (<a href="https://en.wikipedia.org/wiki/Fisher%27s_exact_test#Controversies" class="external-link">FET
Controversies Wiki</a>).</p>
<p>Although in practice, Fisher’s exact test is usually used when sample
sizes are small (e.g., n&lt;5), it is valid for all sample sizes.
However, when sample sizes are large, the computation of the exact test
evaluating the hypergeometric probability function given the marginal
can take a very long time.</p>
</div>
<div class="section level3">
<h3 id="recommendation">Recommendation<a class="anchor" aria-label="anchor" href="#recommendation"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Fisher’s exact test can be used in all scenarios.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="the-poisson-regression-method">3. The Poisson Regression Method<a class="anchor" aria-label="anchor" href="#the-poisson-regression-method"></a>
</h2>
<div class="section level3">
<h3 id="intruduction">Intruduction<a class="anchor" aria-label="anchor" href="#intruduction"></a>
</h3>
<p>The poisson distribution is often used to model count data. If <span class="math inline">\(Y\)</span> is the number of counts following
poisson distribution, the probability mass function is given by <span class="math display">\[
f(y)=\frac{\mu^ye^{-\mu}}{y!}
\]</span> where <span class="math inline">\(\mu\)</span> is the average
number of counts and <span class="math inline">\(E(Y)=Var(Y)=\mu\)</span>.</p>
</div>
<div class="section level3">
<h3 id="methods-1">Methods<a class="anchor" aria-label="anchor" href="#methods-1"></a>
</h3>
<p>This method fits a Poisson model to site-level data and then
calculates residuals for each site. The Poisson model is run using
standard methods in the <code>stats</code> package by fitting a
<code>glm</code> model with family set to <code>poisson</code> using a
“log” link. Site-level residuals are calculated
<code><a href="https://rdrr.io/r/stats/predict.glm.html" class="external-link">stats::predict.glm</a></code> via <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">broom::augment</a></code>.</p>
<p>Let <span class="math inline">\(Y_1, ..., Y_N\)</span> be independent
random variables with <span class="math inline">\(Y_i \sim
Pisson(\mu_i)\)</span> denoting the number of events observed from <span class="math inline">\(n_i\)</span> for the <span class="math inline">\(i\)</span>th observation following poisson
distribution. Then <span class="math inline">\(E(Y_i)=\mu_i=n_ie^{x_i\beta}\)</span>. Thus,the
log-linear generalized linear model (poisson regression) is <span class="math display">\[
\log{\mu_i}=\log{n_i}+x_i\beta \quad Y_i \sim Pisson(\mu_i)
\]</span></p>
<p>where <span class="math inline">\(\log{n_i}\)</span> is an offset
term.</p>
</div>
<div class="section level3">
<h3 id="application-1">Application<a class="anchor" aria-label="anchor" href="#application-1"></a>
</h3>
<p>An example using the KRI: Adverse Events:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfInput</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AE_Map_Raw.html">AE_Map_Raw</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfTransformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Transform_Rate.html">Transform_Rate</a></span><span class="op">(</span><span class="va">dfInput</span>,</span>
<span>  strGroupCol <span class="op">=</span> <span class="st">"SiteID"</span>,</span>
<span>  strNumeratorCol <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>  strDenominatorCol <span class="op">=</span> <span class="st">"Exposure"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfAnalyzed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Analyze_Poisson.html">Analyze_Poisson</a></span><span class="op">(</span><span class="va">dfTransformed</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfFlagged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Flag_Poisson.html">Flag_Poisson</a></span><span class="op">(</span><span class="va">dfAnalyzed</span>, vThreshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfBounds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Analyze_Poisson_PredictBounds.html">Analyze_Poisson_PredictBounds</a></span><span class="op">(</span></span>
<span>        dfTransformed <span class="op">=</span> <span class="va">dfTransformed</span>,</span>
<span>        vThreshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chart</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Visualize_Scatter.html">Visualize_Scatter</a></span><span class="op">(</span><span class="va">dfFlagged</span>, <span class="va">dfBounds</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">dfFlagged</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-68a0647091d8d34bee7e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-68a0647091d8d34bee7e">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["91","83","75","43","10","143","85","173","172","86","56","154","120","150","25","54","127","140","141","156","77","92","144","176","155","67","81","113","152","187","114","34","167","30","18","63","29","177","149","153","51","32","73","61","23","161","168","3","26","158","175","96","99","50","184","13","16","106","131","41","109","69","35","147","9","19","103","6","123","117","33","17","104","101","58","11","102","137","36","53","148","45","142","110","38","126","84","115","71","72","97","178","188","14","57","100","121","186","76","49","27","44","89","180","66","118","185","52","48","174","46","68","160","98","7","70","164","129","159","124","163","136","181","87","122","107","189","111","28","151","12","183","166","139","135","190","20","60","55","138","82","5","40","182","65","78","42","112","165","130","179","119","39","31","80","133","4","116","47","162","94","15","128","171","170","59","105","145","134","62","146","22","64","132","8","157"],[129,83,114,400,8,25,5,36,42,130,151,17,42,35,39,19,0,148,13,6,24,18,0,1,11,12,0,9,8,4,7,14,28,11,0,18,8,6,18,6,20,2,4,44,8,3,1,2,12,0,0,6,0,18,9,13,2,7,16,3,10,33,12,12,4,6,10,1,1,1,1,37,25,7,61,26,8,23,2,7,4,2,10,2,2,2,8,6,33,2,16,6,9,3,6,6,21,15,45,13,15,17,18,4,4,65,8,6,3,20,4,15,28,8,39,12,28,9,4,17,15,12,14,6,39,14,121,12,13,17,6,12,79,222,26,34,7,18,7,33,12,170,13,10,9,8,8,15,4,17,26,15,25,10,35,31,47,18,24,16,157,33,29,11,138,50,25,2,45,164,58,39,34,16,138,57],[11534,4471,7621,23066,13112,20038,10099,19720,21638,15047,18146,407,2271,1591,1915,12817,3586,48028,9390,6566,12743,10166,2793,3344,7322,7214,2129,5894,5385,3719,4678,6550,10471,5558,1350,7603,4346,3614,7178,3516,7513,2013,2687,13556,3948,2222,1437,1666,4660,708,679,2874,662,6044,3558,4586,1411,2774,4991,1430,3284,8744,3738,3684,1606,2116,3100,674,673,672,670,9328,6524,2237,14386,6494,2355,5789,840,2096,1328,775,2693,759,757,754,2126,1652,7509,667,3545,1429,2032,738,1356,1354,4456,3203,9390,2717,3034,3357,3521,757,754,12776,1470,1094,531,3734,673,2679,5134,1346,7176,2020,4932,1423,560,2632,2282,1765,2089,750,6484,2025,22173,1597,1755,2376,624,1513,13419,41429,3676,4955,675,2298,673,4705,1345,30252,1456,1000,847,673,672,1596,219,1876,3130,1514,2957,841,4370,3699,6192,1739,2522,1346,24999,3550,2961,671,20714,5719,2180,4,4554,23569,5983,3366,2690,671,17767,5335],[0.0111843246055141,0.0185640796242451,0.0149586668416218,0.0173415416630538,0.00061012812690665,0.00124762950394251,0.000495098524606397,0.00182555780933063,0.00194102967002496,0.00863959593274407,0.00832139314449465,0.0417690417690418,0.0184940554821664,0.0219987429289755,0.0203655352480418,0.00148240617929313,0,0.00308153577080037,0.00138445154419595,0.000913798355162961,0.00188338695754532,0.00177060790871533,0,0.000299043062200957,0.00150232177000819,0.00166343221513723,0,0.00152697658635901,0.00148560817084494,0.00107555794568432,0.00149636596836255,0.00213740458015267,0.00267405214401681,0.00197912918315941,0,0.00236748651847955,0.00184077312471238,0.00166021029330382,0.00250766230147673,0.00170648464163823,0.00266205244243312,0.000993541977148535,0.00148864905098623,0.00324579521982886,0.00202634245187437,0.00135013501350135,0.00069589422407794,0.00120048019207683,0.00257510729613734,0,0,0.00208768267223382,0,0.00297816015883521,0.00252951096121417,0.0028347143480157,0.00141743444365698,0.00252343186733958,0.00320577038669605,0.0020979020979021,0.00304506699147381,0.0037740164684355,0.00321027287319422,0.00325732899022801,0.0024906600249066,0.00283553875236295,0.0032258064516129,0.00148367952522255,0.00148588410104012,0.00148809523809524,0.00149253731343284,0.00396655231560892,0.00383200490496628,0.00312919088064372,0.00424023356040595,0.00400369571912535,0.00339702760084926,0.00397305234064605,0.00238095238095238,0.00333969465648855,0.00301204819277108,0.00258064516129032,0.00371333085777943,0.00263504611330698,0.00264200792602378,0.0026525198938992,0.00376293508936971,0.0036319612590799,0.00439472632840591,0.00299850074962519,0.00451339915373766,0.00419874037788663,0.00442913385826772,0.0040650406504065,0.00442477876106195,0.00443131462333826,0.00471274685816876,0.00468310958476428,0.00479233226837061,0.00478468899521531,0.00494396835860251,0.00506404527852249,0.00511218403862539,0.00528401585204756,0.00530503978779841,0.00508766437069505,0.0054421768707483,0.00548446069469835,0.00564971751412429,0.00535618639528656,0.00594353640416048,0.00559910414333707,0.00545383716400467,0.00594353640416048,0.00543478260869565,0.00594059405940594,0.0056772100567721,0.00632466619817287,0.00714285714285714,0.00645896656534954,0.00657318141980719,0.00679886685552408,0.00670177118238392,0.008,0.00601480567550895,0.00691358024691358,0.00545708744869887,0.00751408891671885,0.00740740740740741,0.00715488215488216,0.00961538461538462,0.00793126239259749,0.00588717490125941,0.00535856525622149,0.00707290533188248,0.00686175580221998,0.0103703703703704,0.00783289817232376,0.0104011887072808,0.00701381509032944,0.00892193308550186,0.00561946317598836,0.00892857142857143,0.01,0.0106257378984652,0.011887072808321,0.0119047619047619,0.0093984962406015,0.0182648401826484,0.00906183368869936,0.00830670926517572,0.00990752972258917,0.0084545147108556,0.0118906064209275,0.0080091533180778,0.00838064341713977,0.00759043927648579,0.0103507763082231,0.00951625693893735,0.011887072808321,0.0062802512100484,0.00929577464788732,0.00979398851739277,0.0163934426229508,0.00666216085739114,0.00874278720055954,0.0114678899082569,0.5,0.00988142292490119,0.00695829267257839,0.00969413337790406,0.0115864527629234,0.012639405204461,0.0238450074515648,0.00776720887037767,0.0106841611996251],[7.79698375204639,9.42659223224762,9.55765203424339,20.54867849627,-9.19058542301409,-9.08898413299865,-8.43213008959247,-7.3548848950493,-7.34714044415447,5.51498269665516,5.62056963711692,6.15398983378875,6.58213375329956,6.65621880162453,6.72998995881204,-6.81221385428385,-6.20539211957677,-6.11942624134887,-6.09265499695673,-6.00254562701614,-5.89337641874759,-5.53390089615218,-5.50052830400625,-5.31186322349317,-5.21633057343918,-4.90445942658123,-4.82531656326985,-4.677349246283,-4.54714162803657,-4.3625414628504,-4.24387020770379,-3.95795759139349,-3.91910421726914,-3.89281316645459,-3.87326274258675,-3.87149634833225,-3.65164874051094,-3.5659137690724,-3.56278328036539,-3.46676317798925,-3.40357169212474,-3.35093925201496,-3.28691159371403,-3.27802174073964,-3.27330285449161,-3.14338052557323,-3.12784063133864,-2.8771960853142,-2.857974911681,-2.83691245034862,-2.78024429263951,-2.77013311281155,-2.74644129588745,-2.67693221754424,-2.58157022336315,-2.53764750610232,-2.48949068276324,-2.31528965086047,-2.20103603891427,-2.0067879152126,-1.99215621348291,-1.94962877599703,-1.94228992355602,-1.88431339051857,-1.8352587966506,-1.80644624352057,-1.77964427952372,-1.72778218552218,-1.72543009691231,-1.72307586765905,-1.71836096577951,-1.71437036284231,-1.66923026157471,-1.62239803798406,-1.50976409508199,-1.45607175899636,-1.45054979608932,-1.43128294817271,-1.42655292571848,-1.42289883006782,-1.36491943972955,-1.27915397288554,-1.27843280034871,-1.24167215342458,-1.23695156674944,-1.22985572043729,-1.12746079414274,-1.10071370913086,-1.03126869513496,-1.01567299256708,-0.716807442475906,-0.71446316079664,-0.660532839811612,-0.612032698695148,-0.57939105356882,-0.575623089195041,-0.574294759416505,-0.557829247934635,-0.542862392272734,-0.460177437907535,-0.347297516834175,-0.253264748337105,-0.212482397191421,-0.142802072583587,-0.134960664225187,-0.0745985383437693,-0.0504233920263513,-0.050150262966417,-0.0279411956222683,-0.00438749032488486,0.0852465011516422,0.122201504656793,0.148848403056449,0.188124070173638,0.226660890348085,0.27689314317869,0.350583390617853,0.385646522715563,0.424971884663677,0.697051223940848,0.700470262866993,0.706816624726938,0.73383978269735,0.796671288392113,0.820707068175571,0.838451334505534,0.870654848058017,1.01404132983234,1.01953552861098,1.0754883064856,1.17505246305702,1.17613455535024,1.20275322588147,1.23328613758069,1.34774122649161,1.43520376248831,1.44268739740621,1.44873325230538,1.4489503861218,1.51980077946521,1.52023028925082,1.53937638755287,1.59322899614763,1.66510235490664,1.71559976351968,1.85500606129335,1.85822928120779,1.89115462628114,1.89833742938659,1.90554874917389,2.05335606795161,2.05630153481293,2.0813976832627,2.09433198072724,2.25435344434879,2.3133200873725,2.36140782849666,2.42285917001685,2.50956548924792,2.7004110270093,2.71636566595704,2.88761653458948,2.91288125941166,2.98407155020343,3.1142090448795,3.2877546220514,3.30046560685683,3.63811067812571,3.76140610362087,3.95255710894979,4.21034962445929,4.24828491063659,4.32569547937,4.63345247614046,4.66705673676499,4.7464377199325],[59.4387419193194,23.8199308040586,39.8490932288181,116.010476785255,67.2672906377387,101.280192021858,52.2869538164169,99.7288722855947,109.072743817709,76.822179157213,92.0370977912236,2.35864375706733,12.3902152387587,8.78934367533354,10.5106498714401,65.806418356952,19.2534456788527,235.417853374878,48.7405201771623,34.5126811418045,65.4397781184541,52.6216276549928,15.1279058115869,17.9982182176371,38.3394887594218,37.7936859350462,11.6418399678832,31.0980962094602,28.5027093369612,19.9420235229644,24.8831948033992,34.4315292146325,54.1441723880966,29.3857622529559,7.50108213655533,39.7582736571016,23.1770308317401,19.3984828431657,37.6116881267555,18.8906781289844,39.3040622176344,11.0291941081594,14.5735492218594,69.4638614627951,21.1256129674277,12.132164028409,7.96700173579815,9.1888063882523,24.7908036819192,4.02403612547149,3.86487916337728,15.5510188666959,3.77146989587796,31.8614134013052,19.1083687593054,24.4108413537717,7.82786792257446,15.0285951462325,26.4878208625663,7.92955139114481,17.6865198495143,45.501031582554,20.0403205133363,19.7609039045712,8.86928812925332,11.5732408710161,16.729381248602,3.83741446326618,3.83192066672063,3.82642658364367,3.81543755612865,48.4299575866993,34.299642484508,12.211180309986,73.5633583253487,34.1474425573698,12.8321365805172,30.5633693272161,4.74571754957584,11.4676748771993,7.38309893600874,4.39088442087454,14.604948116244,4.30338378898601,4.2924416847566,4.27602662488806,11.6260107152721,9.11428879556967,39.2838706263747,3.7989518547927,19.0409980141065,7.92420081734923,11.1296243111275,4.18844068670289,7.53324761570206,7.5225263454723,23.742816466736,17.2654091523715,48.7405201771623,14.7305191965116,16.3855795551361,18.0657268720214,18.916598445421,4.2924416847566,4.27602662488806,65.6032890529666,8.14346765196061,6.1236823308071,3.04865615633644,20.0196278704487,3.83192066672063,14.5316802000782,27.2197361900957,7.47963569734112,37.6015761994626,11.0661985636964,26.1856284342328,7.89209461131942,3.20916004254973,14.285610616565,12.4481180954597,9.7151357726728,11.4307184428338,4.25413631050308,34.0967037694808,11.0926275611911,111.67379230808,8.82132461767767,9.66201922053982,12.9425297089312,3.56236466250488,8.37320000104543,68.7863640110565,204.127912714185,19.7194966743138,26.3034472701705,3.84290797372033,12.5323229587189,3.83192066672063,25.0217581063307,7.47427373825051,150.710985963222,8.06862048868841,5.61519480003151,4.78387152093942,3.83192066672063,3.82642658364367,8.8159947539171,1.29705725856019,10.3040337806145,16.8855695009001,8.37853986197914,15.9841452266533,4.75116879803873,23.3005174088163,19.8385339605291,32.6139014835651,9.57701061231652,13.7090948768079,7.47963569734112,125.377848830531,19.0669108636854,16.0050079127913,3.82093221359391,104.575113172114,30.2066959405942,11.910818401266,0.0272641377157181,24.2464668590204,118.450592110295,31.5510789077202,18.1124582555876,14.5892489763263,3.82093221359391,90.181584859543,28.2473075815183],[2,2,2,2,-2,-2,-2,-2,-2,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>GroupID<\/th>\n      <th>Numerator<\/th>\n      <th>Denominator<\/th>\n      <th>Metric<\/th>\n      <th>Score<\/th>\n      <th>PredictedCount<\/th>\n      <th>Flag<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":false,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
chart
<p><img src="Statistics%20Method_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="score">Score<a class="anchor" aria-label="anchor" href="#score"></a>
</h3>
<p>TODO. Add GSM scoring and example</p>
</div>
<div class="section level3">
<h3 id="threshold-1">Threshold<a class="anchor" aria-label="anchor" href="#threshold-1"></a>
</h3>
<p>TODO. Add GSM threshold logic and stats rationale</p>
</div>
<div class="section level3">
<h3 id="stop-if-not-situations">STOP-IF-NOT situations<a class="anchor" aria-label="anchor" href="#stop-if-not-situations"></a>
</h3>
<p>TODO. Discuss hard rules on STOP-IF-NOT situations</p>
</div>
<div class="section level3">
<h3 id="poisson-regression-assumptions">Poisson regression assumptions<a class="anchor" aria-label="anchor" href="#poisson-regression-assumptions"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Independence</strong> The responses <span class="math inline">\(y_i\)</span> are independent of each
other.</p></li>
<li><p><strong>Count data</strong> The responses <span class="math inline">\(y_i\)</span> are non-negative integer
(counts).</p></li>
<li><p><strong>Poisson response</strong> Each <span class="math inline">\(Y_i\)</span> follows the Poisson distribution as
noted above with mean and variance equal to <span class="math inline">\(\mu_i\)</span>.</p></li>
<li><p><strong>Linearity</strong> <span class="math inline">\(\log{\mu_i}=\log{n_i}+x_i\beta\)</span> where
<span class="math inline">\(x_i\)</span> are independent
predictors.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="assumption-checks-constraints-and-model-diagnosis">Assumption checks, constraints and model diagnosis<a class="anchor" aria-label="anchor" href="#assumption-checks-constraints-and-model-diagnosis"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>The assumptions on independence and counted data can be assessed
by the knowledge of data collected.</p></li>
<li><p>The assumptions on Poisson response can be checked by plotting
histogram of the data and comparing empirical mean and variance
stratified by the explanatory variable(s). If there is evidence that the
assumption of mean=variance is violated, oftentimes we observe
variance&gt;mean. This is called overdispersion. In this case, negative
binomial distribution provides an alternative where <span class="math inline">\(Var(Y_i)=\phi E(Y_i)\)</span>.</p></li>
<li><p>Diagnosis: Goodness of fit test (chi-squared) and deviance
residuals. Residuals vs fitted plot. Q-Q plot.</p></li>
<li><p>Other considerations: Structural zeros may happen in contrast to
random zeros due to sampling from poisson distribution. In this case, a
mixture model (zero-inflated Poisson model) may be required.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="recommendation-1">Recommendation<a class="anchor" aria-label="anchor" href="#recommendation-1"></a>
</h3>
<p>TODO</p>
</div>
</div>
<div class="section level2">
<h2 id="the-normal-approximation-method">4. The Normal Approximation Method<a class="anchor" aria-label="anchor" href="#the-normal-approximation-method"></a>
</h2>
<div class="section level3">
<h3 id="intruduction-1">Intruduction<a class="anchor" aria-label="anchor" href="#intruduction-1"></a>
</h3>
<p>This method applies funnel plots using asymptotic limits based on
normal approximation of binomial distribution for the binary outcome, or
normal approximation of Poisson distribution for the rate outcome with
volume (the sample sizes or total exposure of the sites) to assess data
quality and safety.</p>
<p>Reference: Zink, Richard C., Anastasia Dmitrienko, and Alex
Dmitrienko. <strong>Rethinking the clinically based thresholds of
TransCelerate BioPharma for risk-based monitoring.</strong>
<em>Therapeutic Innovation &amp; Regulatory Science</em> 52, no. 5
(2018): 560-571.</p>
</div>
<div class="section level3">
<h3 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h3>
<div class="section level4">
<h4 id="binary">Binary<a class="anchor" aria-label="anchor" href="#binary"></a>
</h4>
<p>Consider the problem of monitoring binary outcomes, such as protocol
deviation or discontinuation from the study, across multiple sites in a
clinical trial. Assume that there are <span class="math inline">\(m\)</span> sites with <span class="math inline">\(n_i\)</span> patients at the <span class="math inline">\(i\)</span> th site, <span class="math inline">\(i
= 1, 2, \dots, m\)</span>. Denote the total number of patients in the
study by <span class="math inline">\(n=\sum_{i=1}^m n_i\)</span>. Let
<span class="math inline">\(X_{ij}\)</span> signify the outcome of
interest for the <span class="math inline">\(j\)</span> th patient at
the <span class="math inline">\(i\)</span> th site, where indicates that
an event has occurred and indicates that an event has not occurred.
Finally, let <span class="math inline">\(p_i\)</span> denote the true
event rate at the <span class="math inline">\(i\)</span> th site.
Monitoring tools focus on testing the null hypothesis of consistency of
the true event rates across the sites. Specifically, the null hypothesis
states that the event rate is constant across the sites, that is, <span class="math inline">\(H_0: p_1 = \dots = p_m = p\)</span>, where <span class="math inline">\(p\)</span> is the common event rate. This common
event rate can be estimated as <span class="math inline">\(\hat{p} =
\frac{1}{n}\sum_{i=1}^m\sum_{j=1}^{n_i}X_{ij}\)</span>.</p>
<p>The control limits are computed using confidence limits based on an
asymptotic normal approximation. Let <span class="math inline">\(X_i=\sum_{j=1}^{N_i}X_{ij}\)</span> represent the
total number of events that occur and let r^i ¼ Xi=ni denote the
estimated event rate at the <span class="math inline">\(i\)</span> th
site. The asymptotic <span class="math inline">\(100(1 – a)%\)</span>
confidence interval for <span class="math inline">\(p_i\)</span> is
given by <span class="math display">\[
\hat{p_i}-z_{1-\alpha/2}\sqrt{\frac{\hat{p_i}(1-\hat{p_i})}{n_i}} \leq
p_i \leq
\hat{p_i}+z_{1-\alpha/2}\sqrt{\frac{\hat{p_i}(1-\hat{p_i})}{n_i}}
\]</span> where <span class="math inline">\(z_{1-\alpha/2}\)</span> is
the upper percentile of the standard normal distribution. To construct
the control limits for the observed event rate at this site, the
estimated event rate is forced to be equal to the overall event rate
<span class="math inline">\(\hat{p_i}\)</span>. This means that the
lower and upper asymptotic control limits for the <span class="math inline">\(i\)</span> th site are defined as <span class="math inline">\(l_i=\hat{p}-z_{1-\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n_i}}\)</span>
and <span class="math inline">\(u_i=\hat{p}+z_{1-\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n_i}}\)</span>,
respectively. Asymptotic control limits may not be reliable in smaller
clinical trials, so exact limits for an event rate may be
preferable.</p>
</div>
<div class="section level4">
<h4 id="rate">Rate<a class="anchor" aria-label="anchor" href="#rate"></a>
</h4>
<p>Assume that the number of events up to time <span class="math inline">\(T\)</span> is Poisson with mean <span class="math inline">\(\lambda t\)</span>, where <span class="math inline">\(\lambda\)</span> is the event rate for a given
unit of time. For the <span class="math inline">\(i\)</span> th site
with <span class="math inline">\(X_i=\sum_{j=1}^{N_i}X_{ij}\)</span>
events and <span class="math inline">\(T_i=\sum_{j=1}^{N_i}t_{ij}\)</span> exposure,
define the EAIR as <span class="math inline">\(\hat{\lambda_i}=\frac{X_i}{T_i}\)</span>. For all
sites, define <span class="math inline">\(X=\sum_{i=1}^{m}X_{i}\)</span>
and <span class="math inline">\(T=\sum_{i=1}^{m}t_{i}\)</span> with
<span class="math inline">\(\hat{\lambda}=\frac{X}{T}\)</span>. Under a
normal approximation, <span class="math inline">\(100(1 – a)%\)</span>
confidence interval for the <span class="math inline">\(i\)</span> th
site is <span class="math display">\[
\hat{\lambda_i}-z_{1-\alpha/2}\sqrt{\frac{\hat{\lambda_i}}{T_i}} \leq
p_i \leq
\hat{\lambda_i}+z_{1-\alpha/2}\sqrt{\frac{\hat{\lambda_i}}{T_i}}
\]</span>. For these funnel plots accounting for exposure, the x-axis
representing the site sample size (<span class="math inline">\(n\)</span>) in the above examples is replaced by
the total exposure time <span class="math inline">\(T\)</span>. To
develop a funnel plot, fix <span class="math inline">\(\hat{\lambda_i}=\hat{\lambda}\)</span>, and vary
<span class="math inline">\(T\)</span> from <span class="math inline">\(min(T_i)\)</span> to <span class="math inline">\(max(T_i)\)</span> to compute the control limits.
As an area of future research, the work of Chan and Wang (2009) may
suggest methods appropriate for computing an exact confidence interval
for the EAIR. Finally, similar methods can be applied for a count-type
endpoint <span class="math inline">\(X_{ij}\)</span>, where tij would
denote the time on study for the <span class="math inline">\(j\)</span>
th patient at the <span class="math inline">\(i\)</span> th site.</p>
</div>
</div>
<div class="section level3">
<h3 id="z-score">Z-score<a class="anchor" aria-label="anchor" href="#z-score"></a>
</h3>
<p>For site <span class="math inline">\(i\)</span>, <span class="math inline">\(z_i=\frac{y_i-\theta_0}{\sqrt{V(Y|\theta_0)}}\)</span>,
where <span class="math inline">\(y_i\)</span> is the metric calculated
for site <span class="math inline">\(i\)</span>, <span class="math inline">\(\theta_0\)</span> is the overall mean, <span class="math inline">\(\sqrt{V(Y|\theta_0)}\)</span> is the measurement
of variance.</p>
<p>For binary outcome, <span class="math inline">\(\sqrt{V(Y|\theta_0)}=\sqrt{\frac{\hat{p}(1-\hat{p})}{n_i}}\)</span>.</p>
<p>For rate outcome, <span class="math inline">\(\sqrt{V(Y|\theta_0)}=\sqrt{\frac{\hat{\lambda}}{T_i}}\)</span>.</p>
</div>
<div class="section level3">
<h3 id="over-dispersion-adjustment">Over-dispersion adjustment<a class="anchor" aria-label="anchor" href="#over-dispersion-adjustment"></a>
</h3>
<p>Multiplicative over-dispersion adjustment was performed. <span class="math inline">\(\phi=\frac{1}{m}\sum_{i=1}^m z_i^2\)</span></p>
<p>For binary outcome, <span class="math inline">\(\sqrt{V'(Y|\theta_0)}=\sqrt{\phi\frac{\hat{p}(1-\hat{p})}{n_i}}\)</span>.</p>
<p>For rate outcome, <span class="math inline">\(\sqrt{V'(Y|\theta_0)}=\sqrt{\phi\frac{\hat{\lambda}}{T_i}}\)</span>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by George Wu, Jeremy Wildfire, Matt Roumaya, Nathan Kosiba, Douglas Sanders, Spencer Childress, Li Ge, Colleen McLaughlin, Chelsea Dickens.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
